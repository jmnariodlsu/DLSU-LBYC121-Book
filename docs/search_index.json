[["index.html", "LBYC121 Course Book 1 Introduction 1.1 About Me", " LBYC121 Course Book Jem Marie M. Nario 2026-02-07 1 Introduction Welcome to the LBYC121 Course Book! This book is designed to guide students through the course by providing all necessary resources, materials, and instructions. This course book is intended to ensure that DLSU Carlos L. Tiu-School of Economics students will be able to learn more about Economics Calculus using R. You will find sections on the syllabus, course assessments, lectures, as well as guidance for navigating the course effectively. 1.1 About Me My name is Jem Marie M. Nario, and I am your lecturer for this course. I am excited to guide you through this journey of learning and discovery since I am also on a journey of learning and discovery while teaching part-time. This book is a trial version which will be updated along the course as it also serves as a practice for me. Email: jem.nario@dlsu.edu.ph LinkedIn: linkedin.com/in/jmnario/ Feel free to reach out with any questions or concerns throughout the course. "],["syllabus.html", "2 Syllabus 2.1 Course Description 2.2 Final Course Outputs 2.3 Generative AI-Use Policy 2.4 Classroom Policies", " 2 Syllabus 2.1 Course Description The course aims to discuss how to solve mathematical problems in economics using software packages. Students will be introduced to software packages that are convenient, powerful, and practical to mathematical economic analysis such as Mathematica, R, and Python. Moreover, the course will serve as a catalyst for mastery in basic mathematical economics and an introductory course to more advanced mathematical economic constructs. The course serves to complement lecture-based classes on mathematical economics through the application and use of such software packages. 2.2 Final Course Outputs Course Learning Outcomes Output Due Date CLO1-4 In-Weekly Exercises Week 1-6,8,10-13 CLO1-4 Problem Sets 1 and 2 Week 6 and Week 12 2.3 Generative AI-Use Policy AI Usage by Grade Component Grade Component (Primary Assessments) Usage Policy Level Notes In-class Weekly Exercises (R) Banned Students must write and execute R code independently (pairwork only). Generative AI use is not allowed during in-class exercises, including code generation, debugging, or interpretation of output. Problem Sets (R, team-based) Allowed in specific contexts Generative AI may be used only for: • clarifying R syntax or function documentation • explaining error messages conceptually • reviewing code logic after students have written their own code Generative AI is not allowed for direct generation of full solutions, R scripts, or written interpretations of outputs. AI Usage Policy Statement This course is a technical and skills-based economics course that emphasizes mathematical reasoning, programming in R, and the ability to interpret computational outputs. The primary learning objectives require students to develop hands-on proficiency in R, apply economic logic computationally, and build problem-solving resilience through practice. While generative AI tools can support learning by helping students understand R syntax, documentation, and common error messages, unrestricted use poses a risk to the course’s core objectives—particularly the development of independent coding ability and analytical judgment. Therefore, in this course, students are not allowed to use generative AI during in-class weekly exercises, as these activities are designed to directly assess individual and pair-based mastery of R programming and economic problem-solving in real time. For problem sets, generative AI is allowed only in specific contexts, such as clarifying syntax, understanding error messages, or reviewing code logic after students have produced their own solutions. The direct generation of R code, complete solutions, or interpretations of outputs using generative AI is strictly prohibited. Any use of generative AI beyond the permitted contexts will be treated as academic dishonesty, in accordance with university policy. Students are encouraged to consult the instructor if there is uncertainty about appropriate AI use for a specific task. 2.4 Classroom Policies Learning Etiquette: Practice proper learning etiquette at all times, whether during face-to-face or online sessions, and whether in the classroom or on the university’s official online learning platforms. Academic Integrity: Academic dishonesty of any kind will not be tolerated. Cases will be forwarded to the Student Discipline and Formation Office (SDFO). Always cite sources when using others’ work. If in doubt, seek guidance from the instructor before submission. Use of Class Materials: Improper use of LBYCALC121 materials posted on AnimoSpace (e.g., downloading, copying, sharing, or posting materials elsewhere) violates academic integrity and will be reported to the SDFO. Non-Cooperative Pair Members: If one member of a pair is non-cooperative, the other member may continue with the original partner or work individually. The non-cooperative member must work individually on the required output and inform the instructor. Failure to submit independently will result in a failing mark. Pairs must notify the instructor no later than seven (7) calendar days before submission if such a situation arises. Submission of Exercises and Problem Sets: The Assignment module in AnimoSpace is the sole submission platform for all exercises and problem sets. Submissions via email or other platforms will not be accepted. Student Consultation: Students must request consultations at least 1–2 days in advance. The instructor responds to messages sent via DLSU email only, during weekdays 08:00–18:00. Messages sent on weekends will not receive a reply until the next weekday. Extra Work: Requests for extra work will not be accommodated, especially after Week 14, except for absences officially certified by the Associate Dean. Learning Barriers: Students should immediately inform the instructor of any issues that may affect learning so solutions and adjustments can be made. Correspondence will remain private unless intervention is required (including consultation with DLSU Counseling and Psychological Services). 2.4.1 EXCUSED ABSENCES POLICY: Students must process requests for excused absences from their respective Associate Deans. For SOE students, the Associate Dean of the School of Economics will only process requests for excused absences due to medical and mental health reasons. Covid-related leave requests are no longer accepted as of August 30, 2023. Students must provide official documentation from the Office of Student Affairs (OSA) for absences related to official university functions.  Procedure: Timing: Submit requests immediately upon returning to campus and no later than seven working days from the return date.  Request Letter: Write a letter to the Associate Dean including: Course details (course name, section, faculty names, and emails) Dates of absence(s) Reason for absence with relevant details Supporting Documents: Attach validated documents from the appropriate university offices. Submission: Combine the letter and supporting documents into a single PDF and upload viathis form. Approved absences will be communicated to you and your professors within three working days. Note that processing is done only during regular weekday office hours.  Important: Only complete requests will be processed. Falsifying records is a major offense as per the Student Handbook (Section 9, pp. 85-87). Note: The syllabus is unique to the course per Term, per AY. Final syllabus uploaded in Animospace. "],["assessments.html", "3 Assessments 3.1 In-Weekly Exercises 3.2 Problem Sets 1 and 2 3.3 Grading System 3.4 Grading Scale", " 3 Assessments 3.1 In-Weekly Exercises Each pair submits one PDF per weekly exercise via AnimoSpace Assignment module. First Page: Contains final answers only. This section is checked by the instructor for correctness (Criterion 1). Second Page Onwards: Includes all R code, calculations, plots, and explanations. This section is peer-reviewed for Criterion 2 (Completeness and Analysis) and Criterion 3 (Organization and Neatness). Peer Review: Each pair is assigned 1–2 other pairs to review via AnimoSpace. Reviewers must seriously evaluate all questions using the rubric and provide constructive comments. Deadline: Within 48 hours after submission of the weekly exercise. Instructor Spot-Check The instructor will randomly spot-check 5 peer-reviewed submissions per week to ensure fairness and quality. Grading: Final grade for each weekly exercise combines: Correctness (Canvas quiz / first page of PDF) Completeness and analysis (peer review) Organization and neatness (peer review) Penalty for Low-Quality Peer Review If the majority of peer reviews are inflated, lack serious comments, or do not follow the rubric, a -1 point demerit will be applied to Criterion 2 and 3 for all submissions that week. Rationale: The penalty is in place to ensure that peer review is taken seriously, reinforcing the following course outcomes: CLO1 &amp; CLO2: Mastery of R and mathematical economic processes requires critical evaluation of solutions. CLO3: Clear communication of models and solutions is a professional skill; peer feedback ensures this is developed. CLO4: Resilience in problem-solving comes from iterative work and reflection. Poor peer reviews weakens this outcome. ELGA2 (Effective Communicator): Peer review develops professional communication skills through constructive criticism. ELGA3 (Reflective Lifelong Learner): Evaluating peers’ work enhances reflection on one’s own understanding. ELGA6 (Technically Proficient Professional): Professional competence includes both producing and critically assessing technical work. PLO6 &amp; PLO8: Applying analytical methods and working effectively with others depends on thoughtful evaluation of solutions. Conclusion: Peer review is mandatory and serious. Rubric for In-class Weekly Exercises Criteria Assessment Method Exemplary (4.0) Satisfactory (3.0) Developing (2.0) Beginning (1.0) Correctness of Solutions List Check (First Part of Submission) All answers correct; R commands execute without error Minor errors; results mostly correct Several errors affecting correctness Major/persistent errors; outputs unusable Completeness of Solutions and Analysis Peer Review (Subsequent Parts) All questions answered; interpretations clear and accurate Most questions answered; interpretations mostly correct Some questions missing; interpretations weak Many questions missing; interpretations unclear or missing Organization and Neatness of R Commands Peer Review (Subsequent Parts) Code clearly organized, logical, and easy to follow Generally organized; minor issues Loosely organized; hard to follow Disorganized or unclear; cannot follow 3.2 Problem Sets 1 and 2 Problem Set Schedule Problem Set Assigned Submission Deadline Problem Set 1 Week 3 Week 6, 18:00 Problem Set 2 Week 8 Week 12, 18:00 Late submissions will not be accepted. Pair submission: One PDF per pair uploaded to AnimoSpace Assignment module. Scope Problem Set 1: Covers topics assigned in Weeks 1–3: Introduction to R commands and syntax Single-variable differentiation and derivatives Visualization of functions in R Partial differentiation (basic multivariate functions) Problem Set 2: Covers topics assigned in Weeks 4–8: Advanced partial derivatives and Young’s Theorem Integration (definite and indefinite) Application of first and second-order conditions in economic functions Profit maximization, cost minimization, and special economic functions Visualization and comparative statics in R Only submissions via the Assignment module will be accepted. Submissions by email or other means will not be graded. Rubric for Problem Sets Criteria Exemplary (4.0) Satisfactory (3.0) Developing (2.0) Beginning (1.0) Criterion 1: Correctness of Solutions in R The student provided exact and accurate solutions using appropriate R commands, with no execution errors. The student provided solutions with minor errors in executing R commands that do not substantially affect results. The student provided solutions with several errors in executing R commands that affect correctness. The student provided solutions with major or persistent errors in R commands, resulting in incorrect or unusable outputs. Criterion 2: Completeness of Solutions and Analysis of R Output The student completed all exercises, demonstrated clear understanding of R commands, and provided accurate and insightful interpretations of the output. The student mostly completed the exercises, showed general understanding of R commands, and provided partial or basic interpretations of the output. The student incompletely completed the exercises, showed limited understanding of R commands, and provided weak or unclear interpretations of the output. The student was unable to complete the exercises in R and did not provide meaningful interpretations of the output. Criterion 3: Organization and Neatness of R Commands The student presented R commands in a clear, logical, and well-organized sequence that is easy to follow and reproduce. The student presented R commands in a generally organized sequence that can be followed with minor effort. The student presented R commands in a loosely organized manner that is difficult to follow. The student presented R commands in a disorganized or unclear manner that cannot be followed. Total 4.0 3.0 2.0 1.0 3.3 Grading System In-Weekly Exercises 50% Problem Sets (2) 50% Total 100% 3.4 Grading Scale GRADING SCALE 97.00 - 100.00 90.00 – 96.99 85.00 – 89.99 80.00 – 84.99 75.00 – 79.99 70.00 – 74.99 65.00 – 69.99 00.00 – 64.99 Note: For course credit, students should get a minimum score of 65.00% (equivalent to a grade of 1.0) "],["basic-introduction-to-r.html", "4 Basic Introduction to R 4.1 Session Information 4.2 Preliminaries 4.3 Packages 4.4 Setting up the Working Directory 4.5 Cleaning the Environment (Do This Regularly) 4.6 Quarto Markdown 4.7 Working Directories and File Management 4.8 Mini-Exercise: First Quarto Render (Mandatory per Individual)", " 4 Basic Introduction to R This portion of the book offers an introduction to the basics of R. R offers a wide variety of functionality. Note that this book only offers basic Econometric analysis. It will be useful to have some basic familiarity with R and its syntax but this is not strictly necessary. Each chapter includes both R code and results to make it easier for students to follow along, even without detailed knowledge of R. 4.1 Session Information This version of the book was built using R version 4.4.2. See below for the session information: ## R version 4.5.2 (2025-10-31 ucrt) ## Platform: x86_64-w64-mingw32/x64 ## Running under: Windows 11 x64 (build 26200) ## ## Matrix products: default ## LAPACK version 3.12.1 ## ## locale: ## [1] LC_COLLATE=English_Netherlands.utf8 LC_CTYPE=English_Netherlands.utf8 LC_MONETARY=English_Netherlands.utf8 ## [4] LC_NUMERIC=C LC_TIME=English_Netherlands.utf8 ## ## time zone: Asia/Manila ## tzcode source: internal ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] nleqslv_3.3.5 Ryacas_1.1.6 Deriv_4.2.0 ## ## loaded via a namespace (and not attached): ## [1] digest_0.6.39 R6_2.6.1 bookdown_0.46 fastmap_1.2.0 xfun_0.55 magrittr_2.0.4 cachem_1.1.0 ## [8] knitr_1.51 htmltools_0.5.9 rmarkdown_2.30 lifecycle_1.0.4 cli_3.6.5 sass_0.4.10 grid_4.5.2 ## [15] jquerylib_0.1.4 compiler_4.5.2 rstudioapi_0.17.1 tools_4.5.2 bslib_0.9.0 evaluate_1.0.5 Rcpp_1.1.0 ## [22] yaml_2.3.12 jsonlite_2.0.0 rlang_1.1.6 4.2 Preliminaries The first step is to gain access to R, which is free and available on the R website: http://cran.r-project.org/. Simply go to the R website, select the appropriate location and operating system, and follow the instructions to download the base distribution of R. RStudio offers a user friendly environment to run R and is recommended. Once R is opened, we can begin to run commands. R commands can be run directly from the console, from the R script editor or from a text editor separate from R. 4.2.1 Understanding the RStudio Screen Console (Bottom Left) This is where you see the output from your code Error messages Warnings You can type R commands directly in the console after the &gt; and press Enter to run them. Try it! Type 3*9 Use the console for: Quick calculations Testing commands Seeing results Important! Anything types only in the console is not saved. Script/Editor Area (Top Left) The Script area is where you write and save your code or Quarto documents. This is where R scripts and qmd files are written. Code here is saved, reproducible, and reusable. To run code from the script: Select a line and press Ctrl+Enter (Windows) or Cmd+Enter (Mac) or just place the cursor beside the line to run it. Run a whole chunk in Quarto Rule: Always write code in the script/editor, not in the console. Environment (Top Right) The Environment shows all objects currently in memory such as data frames, variables, functions, models. Try this: type jmn&lt;-1101 in the console. After running this, jmn will appear in the Environment. If something does NOT appear, it does not exist in your session. Files, Plots, Packages, Help, Viewer (Bottom Right) This panel has multiple tabs: Files Shows files in your working directory. Your working directory can be seen just below the Console, the one after ~ Use this to navigate project files Plots Displays graphs created by code Packages Shows list of installed packages. Checkboxes allow loading/unloading packages but you still need to add in the code library() in scripts for reproducibility. Help Displays help pages Viewer Shows rendered HTML outputs Used when previewing Quarto documents R offers detailed help files for each function. To access help, run: ?sum All lines proceeded by a # are comments and will not run*. For example: # This is a comment. R will not recognize this as a command. 4.3 Packages Each package of interest must be installed and loaded before it can be used. The packages will not be immediately available when R is opened. A package only has to be installed once on a computer, but the package will have to be loaded every time R is restarted. We can install a package individually as we need them. For example, to install tidyverse and psych, we would do: install.packages(&quot;tidyverse&quot;) install.packages(&quot;psych&quot;) In the tidyverse package, the ggplot2 is usually included; if you do not see the package in the Packages list at the lower right, you can do this: if(!(&quot;ggplot2&quot; %in% installed.packages()[,&quot;Package&quot;])) install.packages(&quot;ggplot2&quot;) Now that we have our packages successfully installed, we can go ahead and load them into R. Here we will load the tidyverse package as an example. We can use of all the functions available in that package once it is loaded into R. We load packages by using a library() function. The input is the name of the package, not in quotes. library(tidyverse) We can look up all of the functions within a package by using a help() function. For example, let’s look at the functions available in the tidyverse package. help(package = tidyverse) Note that the package argument is necessary to look up all of the functions. We can also detach a package if we no longer want it loaded. This is sometimes useful if two packages do not play well together. Here we will use a detach() function. detach(package:tidyverse) For simplicity, we will assume that the reader has restarted R at the beginning of each tutorial. 4.4 Setting up the Working Directory MOST IMPORTANT! If your working directory is incorrect, R will not find your files and your code will fail even if it is correct. 4.4.1 What is a Working Directory? The working directory is the folder where R looks for data files, saves outputs, where .qmd files should be placed. You will only use one main local folder as your working directory (technically two: one in your laptop, one in your university account computer) 4.4.2 Required Folder Structure Create a folder: DLSU_COURSE_SECTION This folder is your local working directory. On university computers: create this folder inside your university account storage. On your personal computer: create this folder anywhere convenient for you. All qmd files must be placed inside this folder! 4.4.3 Setting the Working Directory in RStudio This method works on both Windows and Mac and avoids typing errors. Open RStudio Go to Session&gt;Set Working Directory&gt;Choose Working Directory Select the folder DLSU_COURSE_Section Click Open Once set, R will treat this folder as the default location for all files; meaning, all files in the course should be placed in this folder. Download files then place in this folder. 4.4.4 Setting the Working Directory Using Code This is a hassle as you will manually code working directory using setwd() Windows: # Use double backslashes \\\\ or forward slashes / setwd(&quot;C:\\\\Users\\\\YourUsername\\\\Documents\\\\DLSU_COURSE_Section&quot;) setwd(&quot;C:/Users/YourUsername/Documents/DLSU_COURSE_Section&quot;) Mac: # Use forward slashes / setwd(&quot;/Users/YourUsername/Documents/DLSU_LBOMETR_Section&quot;) How to get the path? I forgot! Just kidding. I just right-click on the file and copy as path name. I am not sure how it is with Mac, I think same, right click but press option so the path name will show up. To confirm your working directory: getwd() If the printed path is NOT DLSU_COURSE_Section, fix it. 4.5 Cleaning the Environment (Do This Regularly) You should clean your environment at the start of a new lecture, when switching datasets, or when something behaves unexpectedly. # Remove all objects from the environment rm(list = ls()) # Free up memory (makes processor faster) gc() The Environment panel should be empty. You are always starting with a clean session. 4.6 Quarto Markdown In this course, Quarto Markdown (.qmd files). Quarto Markdown is a tool for creating documents, reports and presentations using Markdown and executable code. 4.6.1 Installing Quarto in R Before starting, install the quarto R package if not already installed: install.packages(&quot;quarto&quot;) 4.6.2 Starting a Quarto Document To begin creating a Quarto document, follow these steps: Open RStudio. Go to File &gt; New File &gt; Quarto Document. Choose the document type (e.g., HTML, PDF, Word, etc.) and specify whether the document will include code. For ease, we will use the html document type. Use the visual editor for ease of editing. 4.6.3 YAML Header Use Here is the YAML header for all quarto documents that you will submit along with line-by-line explanations. title: “TITLE of the FILE” This contains the title of the document. It appears at the top and in the browser tab. author: “put your name here” Replace with your name. Identifies the document author. date: today Automatically inserts the current date. format: html: toc: true theme: united embed-resources: true Format specifies the output type (html in this case), adds a table of contents, sets a bootstrap html theme (you can use other themes but this is preferred), embeds all resources in the html file. knitr: opts_chunk: warning: false message: false Controls code chunk behavior, meaning, it hides warnings and hides messages when rendering. editor: visual Uses the visual editor in Rstudio for the output Marks the end of the YAML header. As a whole, the YAML header looks like this: 4.6.4 Quarto Key Features Code Chunks Code chunks allow you to include and run code inside your document. To make code chunks, long way (there is shortcut later). Type ```{r} then press Enter. If you want to run the specific code chunk, you can also press the green play button at the right side of the chunk. If you want to run previous code chunks, press the button that has an arrow down with a green line below, just beside the green play button. jem&lt;-15+50+143 Inline Code Embed R code in text using backticks and r . Try typing this: The total number of pairs is “r 15+12”. Replace the quotation marks with backticks. When you render the file, what should come out beside is would be the number 27. 4.6.5 Quarto Markdown Shortcuts Action Windows Shortcut Mac Shortcut Insert a new code chunk Ctrl+Alt+I Cmd+Alt+I Run current code chunk Ctrl+Shift+Enter Cmd+Shift+Enter Run all code chunks Ctrl+Alt+R Cmd+Alt+R Run current line/selection Ctrl+Enter Cmd+Enter Knit/Render document Ctrl+Shift+K Cmd+Shift+K Comment/uncomment lines Ctrl+Shift+C Cmd+Shift+C Insert pipe (%&gt;%) Ctrl+Shift+M Cmd+Shift+M Headings /Number of Heading (if in Visual mode) Prefix line with #, ##, etc. manually (in Source mode) /Number of Heading (if in Visual mode) Prefix line with #, ##, etc. manually (in Source mode) Bold Ctrl+B Cmd+B Italic Ctrl+I Cmd+I Inline code Surround with backticks (’) manually Surround with backticks (’) manually 4.6.6 Rendering a Quarto Document Rendering is the process of turning your .qmd file into an html. No rendering done, no submission. In this course, you will primarily render to HTML. 4.6.6.1 Render Using RStudio Button (DO THIS) Open your qmd file Make sure it is saved in the working directory Click Render button at the top of the editor. It looks like a blue arrow with the word Render. RStudio will run all code chunks, convert the document to HTML then open the result in the Viewer pane. If the render is successful, an html file will appear in your Files tab. You can double-click on the html file in your Files so that it appears in a bigger window which you can use to print as PDF. 4.7 Working Directories and File Management You will always work locally first. Each student must: Edit .qmd files only inside their local DLSU_COURSE_Section folder. Render HTML files locally to check for errors Never edit files directly inside Google Drive via a browser 4.7.1 File Naming Convention (Mandatory) To avoid confusion, all .qmd files must follow this format: initials_topic.qmd Example: jmn_descriptives.qmd jmn_visualization.qmd/ 4.8 Mini-Exercise: First Quarto Render (Mandatory per Individual) This exercise checks that you can write, run, and render a Quarto document correctly. Instructions: Create a new Quarto HTML document in RStudio. Keep the YAML header exactly as shown earlier in this chapter. In the body of the document, do the following steps: a. Add a Section Header Below the YAML header, add the following Markdown header: About Me as Heading 1 Under this header, write 2-3 sentences introducing yourself (name, program, year, hobbies) b. Add Inline Code for your age In the same section, add a sentence that includes inline R code. Sentence: I am “r 2026-type your year of birth” years old. Do NOT calculate your age manually. The age must be computed by R. The number should appear as plain text in the sentence. c. Add a Code Chunk Insert a new R code chunk. Inside the chunk: Add a comment saying this is just a test Create an object named after your initials Add the alphabetical positions of your initials Print the result Example: #This is just a test jmn&lt;-10+13+14 print(jmn) ## [1] 37 d. Render the document This exercise will help you in future lectures! e. Create a new Quarto document Clean the environment and free up the memory. Don’t forget your YAML header before the code chunk including the cleaning and freeing the memory! "],["differentiation-rules.html", "5 Differentiation Rules 5.1 Introduction 5.2 Structure of Differentiation 5.3 Constant Rule 5.4 Power Rule 5.5 Constant Multiple Rule 5.6 Sum and Difference Rule 5.7 Polynomial Functions (Combined Rules) 5.8 Exponential Functions 5.9 Logarithmic Functions 5.10 Product Rule 5.11 Quotient Rule 5.12 Chain Rule 5.13 Things to Note: 5.14 Exercises", " 5 Differentiation Rules 5.1 Introduction Differentiation measures the instantaneous rate of change of a function wrt its variable. We use differentiation in getting the marginal cost, marginal utility or the marginal product. In R, derivatives are computed symbolically (using expressions) or numerically. 5.2 Structure of Differentiation D() is R’s built-in symbolic differentiation function. It takes a mathematical expression and returns its derivative wrt a variable. D(expr, name) expr is the function you want to differentiate name is the variable you differentiate with respect to. Example: D(expression(x^2), &quot;x&quot;) ## 2 * x There is a need to put expression, because without it, R cannot do it. For example I made x have a value because if it is simply \\[x^3\\] there will be an error. Here is the difference: D(expression(x^3), &quot;x&quot;) ## 3 * x^2 x&lt;-3 D((x^3), &quot;x&quot;) ## [1] 0 Basically, the expression preserves the equation that you are trying to differentiate. 5.3 Constant Rule If \\[f(x)=c\\] where c is a constant, then \\[f&#39;(x)=0 \\] 5.3.1 Example \\[ f(x)=10 \\] Derivative: \\[f&#39;(x)=0\\] 5.3.1.1 R Implementation D(expression(10), &quot;x&quot;) ## [1] 0 5.4 Power Rule If \\[f(x)=x^n\\] then \\[f&#39;(x)=nx^{n-1}\\] 5.4.1 Example \\[ f(x)=x^3 \\] Derivative: \\[f&#39;(x) = 3x^2\\] 5.4.1.1 R Implementation D(expression(x^3),&quot;x&quot;) ## 3 * x^2 5.4.2 Example \\[ f(x)=x^{1/2} \\] Derivative: \\[ f&#39;(x)=\\frac{1}{2}x^{\\frac{-1}{2}} \\] 5.4.2.1 R Implementation D(expression(x^(1/2)), &quot;x&quot;) ## x^((1/2) - 1) * (1/2) 5.5 Constant Multiple Rule If \\[f(x)=a*g(x)\\] then \\[f&#39;(x) = a*g&#39;(x)\\] 5.5.1 Example \\[ f(x)=5x^2 \\] Derivative: \\[f&#39;(x)=10x\\] 5.5.1.1 R Implementation D(expression(5*x^2), &quot;x&quot;) ## 5 * (2 * x) 5.6 Sum and Difference Rule If \\[f(x)=g(x)+h(x)\\] then \\[f&#39;(x)=g&#39;(x)+h&#39;(x)\\] Same applies for subtraction. 5.6.1 Example \\[ f(x)=x^2+3x+9 \\] Derivative: \\[f&#39;(x)=2x+3\\] 5.6.1.1 R Implementation D(expression(x^2+3*x+9), &quot;x&quot;) ## 2 * x + 3 5.7 Polynomial Functions (Combined Rules) Most economic functions are polynomials (i.e. cost function) 5.7.1 Example \\[ C(q)=2q^3-5q^2+10q-100 \\] This is a cost function. Derivative (Marginal Cost): \\[MC(q)=6q^2-10q+10\\] 5.7.1.1 R Implementation D(expression(2*q^3-5*q^2+10*q+100), &quot;q&quot;) ## 2 * (3 * q^2) - 5 * (2 * q) + 10 5.8 Exponential Functions If \\[f(x)=e^x\\] then \\[f&#39;(x)=e^x\\] If \\[f(x)=a^x\\] then \\[f&#39;(x)=a^x ln(a)\\] 5.8.1 Example \\[ f(x)=e^x \\] 5.8.1.1 R Implementation D(expression(exp(x)), &quot;x&quot;) ## exp(x) 5.8.2 Example \\[ f(x)=2^x \\] D(expression(2^x), &quot;x&quot;) ## 2^x * log(2) 5.9 Logarithmic Functions If \\[f(x)=ln(x)\\] then \\[f&#39;(x)=\\frac{1}{x}\\] If \\[f(x)=ln(g(x))\\] then \\[f&#39;(x)=\\frac{g&#39;(x)}{g(x)}\\] This is usually for elasticities, utility or diminishing returns 5.9.1 Example \\[ f(x)=ln(x) \\] 5.9.1.1 R Implementation D(expression(log(x)), &quot;x&quot;) ## 1/x 5.9.2 Example \\[ f(x)=ln(5x) \\] 5.9.2.1 R Implementation D(expression(log(5*x)), &quot;x&quot;) ## 5/(5 * x) 5.10 Product Rule If \\[f(x)=g(x)h(x)\\] then \\[f&#39;(x)=g&#39;(x)h(x)+g(x)h&#39;(x)\\] This is especially used for Revenue = Price*Quantity 5.10.1 Example \\[ R(q)=q(10-q) \\] Derivative: \\[R&#39;(q)=10-2q\\] 5.10.1.1 R Implementation D(expression(q*(10-q)), &quot;q&quot;) ## (10 - q) - q 5.11 Quotient Rule If \\[f(x)=\\frac{g(x)}{h(x)}\\] then \\[f&#39;(x)=\\frac{g&#39;(x)h(x)-g(x)h&#39;(x)}{h(x)^2}\\] This is used for average cost or average product 5.11.1 Example \\[ AC(q)=\\frac{2q^2+10}{q} \\] 5.11.1.1 R Implementation D(expression((2*q^2+10)/q),&quot;q&quot;) ## 2 * (2 * q)/q - (2 * q^2 + 10)/q^2 5.11.2 Example If you are given the following: \\[ TC(q)=q^3+4q^2+10q+100 \\] so, you need to construct average cost: \\[ AC(q)=\\frac{q^3+4q^2+10q+100}{q} \\] 5.11.2.1 R Implementation D(expression((q^3+4*q^2+10*q+100)/q),&quot;q&quot;) ## (3 * q^2 + 4 * (2 * q) + 10)/q - (q^3 + 4 * q^2 + 10 * q + 100)/q^2 5.12 Chain Rule If \\[f(x)=g(h(x))\\] then \\[f&#39;(x)=g&#39;(h(x))\\cdot h&#39;(x)\\] This is used in CES functions 5.12.1 Example \\[ f(x)=ln(x^2+1) \\] Derivative: \\[f&#39;(x)=\\frac{2x}{x^2+1}\\] 5.12.1.1 R Implementation D(expression(log(x^2+1)), &quot;x&quot;) ## 2 * x/(x^2 + 1) 5.13 Things to Note: You have to check that you are typing the correct codes, equations, etc. You need to write expression() completely as exp is different. Always check the parentheses, commas, etc. 5.14 Exercises For this exercise, please place final answers in the first part while the next parts would show the R codes per question. For the Peer Review, please look at whether the codes are complete and correctly written. Write comments based on the rubric for checking. Since this is simply for recalling purposes, simply differentiate the following equations: \\[ f(x)=101314 \\] \\[ f(x)=x^4 \\] \\[ f(x)11x^4 \\] \\[ f(x)=x^2+5x-9 \\] \\[ f(x)=x^2-10x+20 \\] \\[ C(q)=q^3-4q^2+6Q+50 \\] \\[ f(x)=e^{2x} \\] \\[ f(x)=ln(3x^2) \\] \\[ R(q)=q(20-2q) \\] \\[ AC(q)=\\frac{5q^2+20}{q} \\] Total Product is \\[TP(L)=10L^2 -L^3\\] Get \\[AP(L)\\] Differentiate \\[AP(L)\\] with respect to \\[L\\] \\[ f(x)=ln(1+x^3) \\] "],["review-of-single-variable-differentiation-rules-and-visualizing-functions.html", "6 Review of Single-Variable Differentiation Rules and Visualizing Functions 6.1 Economic Example 6.2 Writing Greek Letters 6.3 Square Roots and Powers", " 6 Review of Single-Variable Differentiation Rules and Visualizing Functions rm(list=ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 1840629 98.4 3242938 173.2 3242938 173.2 ## Vcells 4147721 31.7 10146329 77.5 10146329 77.5 6.1 Economic Example We already discussed how to get Marginal Cost, etc. from the last chapter; here, we review how to get Marginal Cost, Average Cost. 6.1.1 Total Cost Function Definition Say you are given a Total Cost function: \\(TC(Q) = Q^3 - 12Q^2 + 60Q\\) We can create a function of the Total Cost. This will help when we want to evaluate the model at a certain quantity. TC&lt;- function(Q) Q^3 - 12*Q^2 + 60*Q What you are doing here is that you are creating a new object, TC. Then, function(Q) is defining the mathematical function (you are defining the Total Cost function). Q is the quantity. 6.1.2 Average Cost Function Definition Then, you are now going to define the Average Cost function given as: \\(AC(Q) = \\frac{TC(Q)}{Q}\\) We create the Average Cost function in R which will help us evaluate later on: AC&lt;-function(Q) TC(Q)/Q Once again, we are creating a new object, AC, then defining the average cost function function(Q). 6.1.3 Marginal Cost using Deriv Unlike before where we used D(expression, name) , we will use the Deriv package. Therefore, install and load the Deriv package. if(!(&quot;Deriv&quot; %in% installed.packages()[,&quot;Package&quot;])) install.packages(&quot;Deriv&quot;) We know that the Marginal Cost function is: \\(MC(Q) = \\frac{dTC}{dQ}\\) So, we use the Deriv package to get the first derivative of TC with respect to Q. library(Deriv) MC&lt;-Deriv(TC, &quot;Q&quot;) 6.1.4 Evaluating at a specific quantity We defined our functions, TC, AC, and MC. If you are given a specific quantity, what is the TC, AC, and MC? We can simply do this in R: TC(20) ## [1] 4400 AC(20) ## [1] 220 MC(20) ## [1] 780 You can double-check in the console by computing manually if the answers are correct. So, what we did is simply evaluate the functions at (Q=20) 6.2 Writing Greek Letters In code, it is better to write the name of the Greek letter, however, when writing it in the final answer, that is the time you put it as the Greek Letter. So, let’s say you are differentiating \\[f(\\gamma)=5\\gamma^2\\], this is how it should be done: D(expression(5*gamma^2), &quot;gamma&quot;) ## 5 * (2 * gamma) Some usual Greek Letters: Greek Letter R code in inline Math (Final Answer) R code in code chunk ⍺ $\\alpha$ alpha  $\\beta$ beta  $\\gamma$ gamma  $\\theta$ theta Example expression: \\(f(\\gamma)=ln(\\theta)+e^2+e^{ln(\\gamma)}\\) For reference: f(\\gamma)=ln(\\theta)+e2+e{ln(\\gamma)} In a code chunk, when you are defining: f&lt;-function(gamma, theta) log(theta) + exp(2) + exp(log(gamma)) log() = natural logarithm exp() = exponential function 6.3 Square Roots and Powers Say you have repeated square root: \\(\\sqrt{\\sqrt{\\sqrt{\\theta+1}}}\\) To write this in inline Math, it is this: \\sqrt{\\sqrt{\\sqrt{\\theta+1}}} Now, let us create a function. Given that the nested square roots would be complicated, we can simplify to have decimals as exponents: Reduce(`*`, rep(1/2, 3)) ## [1] 0.125 We use Reduce to help us find out the equivalent exponent of nested square roots. Square root is simply \\(expression^{1/2}\\), then we simply say how many square roots are present. It’s 3 in this case. We can now write the function: t&lt;-function(theta) (theta+1)^0.125 6.3.0.1 First Derivative library(Deriv) Dt&lt;- Deriv(t, &quot;theta&quot;) Dt ## function (theta) ## 0.125/(1 + theta)^0.875 Now, if you want to change decimals to fractions, use the MASS package. MASS::fractions(0.875) #:: because we are specifying that we are using fractions code in the MASS package. There are fractions that are from other packages so we need to specify ## [1] 7/8 MASS::fractions(0.125) ## [1] 1/8 Therefore, when writing the final answer: \\(f&#39;(\\theta)=\\frac{1/8}{(1+\\theta)^{7/8}}\\) f’(\\theta)=\\frac{1/8}{(1+\\theta)^{7/8}} 6.3.0.2 Higher-Order (nth) Derivatives So, our example would be: \\(f(x) = x^5 + x^4 + x^3 +x^2 + x +1\\) We define the function: If you have R GUI that is 4.1.0 and later, we can change the word function to backslash as a shorter way. It works the same. ONLY do this if you have 4.1.0 and later. fx&lt;-\\(x) x^5 + x^4 + x^3 +x^2 + x +1 We use the Deriv package: library(Deriv) D4fx&lt;-Deriv(fx, &quot;x&quot;, nderiv = 4) D4fx ## function (x) ## 120 * x + 24 The nderiv is added and this is where you put whether you are getting the 4th derivative, 3rd, and so on. Some answers have things like .e1&lt;- this is like a placeholder, you can substitute .e1 with what comes after the arrow in your equations. "],["visualizing-functions-with-ggplot2.html", "7 Visualizing Functions with ggplot2 Saving the Plots for Copy-Paste in Word/Google Docs for ggplot 7.1 Interpretation Guide: 7.2 Mini-Exercise 2.1", " 7 Visualizing Functions with ggplot2 7.0.1 Pre-plotting Check In some cases, ggplot2 does not run. This can be brought by package mismatch, so, we need to double-check that everything is working properly. user &lt;- file.path(Sys.getenv(&quot;USERPROFILE&quot;), &quot;R&quot;, &quot;win-library&quot;, &quot;4.5&quot;) dir.create(user, recursive = TRUE, showWarnings = FALSE) .libPaths(c(user, .libPaths())) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) if (!ok) { install.packages(&quot;rlang&quot;, lib = user_lib) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) } if (!ok) plot(1:5, rnorm(5)) If it is not working, we will use Base R, so go to Base R. 7.0.2 1. Plotting a Single Function We load the ggplot2 package to make plots. 7.0.2.0.1 a. Load ggplot2 package library(ggplot2) 7.0.2.0.2 b. Create values for Q Q_vals&lt;-seq(0,50, length.out = 100) We create a sequence of numbers using seq(), 0, 50 the start and end of the sequence while length.out=100 creates 100 numbers evenly spaced between 0 and 50. If you have more points with the length.out the curve will be smoother when we do the plotting. 7.0.2.0.3 c. Create data frame for plotting df_tc&lt;-data.frame(Q = Q_vals, TC = TC(Q_vals)) data.frame() creates the table of data Q=Q_vals is the column that is created. We store all the quantities (from 0 to 50) TC = TC(Q_vals) is the column for TC storing the total cost for each Q. 7.0.2.0.4 d. Plotting the curve You might get worried because there are warnings that will appear, however, those are not really worrisome. If you do not want to be stressed, you can remove the warnings. You can do that by adding in the code chunk where you can see {r}, {r, warning=FALSE}. library(ggplot2) p1&lt;-ggplot(df_tc, aes(x = Q, y = TC)) + geom_line(size = 1.2, color = &quot;darkgreen&quot;)+ labs(title = &quot;Plot of Total Cost Curve&quot;, x = &quot;Q&quot;, y= &quot;Cost&quot;)+ theme_minimal() print(p1) i. ggplot(df_tc, aes(x = Q, y = TC)) This starts the plot using the df_tc we created as the data. aes(x = Q, y = TC) tells R that you are putting Q on the x-axis and TC on the y-axis ii. geom_line(size = 1.2, color = \"darkgreen\") This draws our line connecting all points (Q, TC) size = 1.2 means thicker line than the default of 1. color = \"darkgreen\" is the line color. You can experiment. So, if the color you want will not appear, ggplot does not have it. iii. labs(title = \"Plot of TC\", x = \"Q\", y = \"Cost\") This adds labels like the title and axis names iv. theme_minimal() Makes the plot cleaner and simpler, with less clutter. 7.0.2.1 Base R Plotting options(scipen = 999) p1.1&lt;-plot(df_tc$Q, df_tc$TC, type = &quot;l&quot;, col = &quot;darkgreen&quot;, lwd = 2, main = &quot;Plot of Total Cost Curve&quot;, xlab = &quot;Q&quot;, ylab = &quot;Cost&quot; ) print(p1.1) ## NULL i. options (scipen=999) is added because unlike ggplot2, Base R tends to use scientific notation. It does not look that nice, so, to avoid that, add this. ii. plot(df_tc$Q, df_tc$TC) portion is the aes portion in ggplot2. type = \"l\", col = \"darkgreen\", lwd = 2 so this makes the plot a line graph, color is dark green and the line width is thicker, The other parts are the labels. 7.0.3 2. Multiple Functions in One Plot (MC and AC) We already have our MC and AC functions. We also have Q_vals too. 7.0.3.0.1 a. Define the functions 7.0.3.0.2 b. Prepare the data in long format for ggplot ggplot2 prefers long format which looks like this: Q Value Type 0 10 MC 0.1 12 MC … … MC 0 15 AC 0.1 14 AC … … AC dfc&lt;-data.frame( Q = rep(Q_vals, 2), Value = c(MC(Q_vals), AC(Q_vals)), Type = rep(c(&quot;MC&quot;, &quot;AC&quot;), each = length(Q_vals)) ) rep(Q_vals, 2) repeat Q for both curves Value is so that MC and AC values are stacked Type tells ggplot which line is which 7.0.3.0.3 c. Plotting AC and MC library(ggplot2) p2&lt;-ggplot(dfc, aes(x = Q, y = Value, color = Type, linetype = Type, size = Type)) + geom_line() + scale_linetype_manual(values = c(&quot;MC&quot; = &quot;dashed&quot;, &quot;AC&quot; = &quot;solid&quot;)) + scale_color_manual(values = c(&quot;MC&quot; = &quot;pink&quot;, &quot;AC&quot; = &quot;purple&quot;)) + scale_size_manual(values = c(&quot;MC&quot; = 1, &quot;AC&quot; = 1.5)) + labs(title = &quot;MC and AC Curves&quot;, x = &quot;Q&quot;, y = &quot;Cost&quot;) + coord_cartesian(ylim = c(0, 100)) + theme_minimal() print(p2) i. aes(color = Type, linetype = Type, size = Type automatically maps line style ii. coord_cartesian(ylim = c(0,100)) This zooms the y-axis without cutting the data. iii. Specifying the line style using scale_linetype_manual instead of letting R do the lines. So, AC is set as the solid line and MC is set as the dashed line. scale_color_manual specifying the color per line. scale_size_manual specifies the thickness of the lines. Inside the parenthesis for all, you have to add c() because you have a “collection” of curves. iv. labs for the labels and theme_minimal() for a clean look. 7.0.3.1 Base R Plotting options(scipen = 999) y_min &lt;- 0 y_max &lt;- 100 p2.1&lt;-plot(dfc$Q, dfc$Value, type = &quot;n&quot;, xlab = &quot;Q&quot;, ylab = &quot;Cost&quot;, ylim = c(y_min, y_max), main = &quot;MC and AC Curves&quot;) lines(dfc$Q[dfc$Type == &quot;AC&quot;], dfc$Value[dfc$Type == &quot;AC&quot;], col = &quot;purple&quot;, lwd = 2, lty = 1) lines(dfc$Q[dfc$Type == &quot;MC&quot;], dfc$Value[dfc$Type == &quot;MC&quot;], col = &quot;pink&quot;, lwd = 2, lty = 2) legend(&quot;topright&quot;, legend = c(&quot;AC&quot;, &quot;MC&quot;), col = c(&quot;purple&quot;, &quot;pink&quot;), lwd = c(2,2), lty = c(1,2)) print(p2.1) ## NULL i. plot(dfc$Q, dfc$Value, type = \"n\" creates the plot, much like the aes ii. the labels are then added, alongside the ylim which is the equivalent of coord_cartesian in ggplot2 iii. lines(...) draws each curve individually, the lty is the line type, (1 for solid, 2 for dashed), lwd is line thickness, col is color, the legend adds legend to match colors and line types manually. 7.0.4 3. Multiple Functions in One Plot (MR, MC, AC) 7.0.4.0.1 a. Getting TR and MR Let us define the price as a function of Q: P&lt;-\\(Q) 100-2*Q TR&lt;- \\(Q) P(Q)*Q We get the Marginal Revenue that is the derivative of TR library(Deriv) MR&lt;- Deriv(TR, &quot;Q&quot;) 7.0.4.0.2 b. Prepare the data df3&lt;-data.frame( Q=rep(Q_vals,3), Value=c(MC(Q_vals), AC(Q_vals), MR(Q_vals)), Type = rep(c(&quot;MC&quot;, &quot;AC&quot;, &quot;MR&quot;), each = length(Q_vals)) ) The only difference is that we now have three curves: MC, AC, and MR. 7.0.4.0.3 c. Plot MC, AC, MR p3&lt;-ggplot(df3, aes(x = Q, y = Value, color = Type, linetype = Type, size = Type)) + geom_line() + scale_color_manual(values = c(&quot;MC&quot; = &quot;pink&quot;, &quot;AC&quot; = &quot;purple&quot;, MR = &quot;skyblue&quot;)) + scale_linetype_manual(values = c(&quot;MC&quot; = &quot;dashed&quot;, &quot;AC&quot; = &quot;solid&quot;, &quot;MR&quot; = &quot;dotdash&quot;)) + scale_size_manual(values = c(&quot;MC&quot; = 1, &quot;AC&quot; = 1.5, &quot;MR&quot; = 1)) + labs(title = &quot;MC, AC, and MR Curves&quot;, x = &quot;Q&quot;, y = &quot;Cost / Revenue&quot;) + coord_cartesian(ylim = c(0, 120)) + theme_minimal() print(p3) 7.0.4.1 Base R Plotting options(scipen = 999) y_max1 &lt;- 120 p3.1&lt;-plot(df3$Q, df3$Value, type = &quot;n&quot;, xlab = &quot;Q&quot;, ylab = &quot;Cost / Revenue&quot;, ylim = c(y_min, y_max1), main = &quot;MC, AC, and MR Curves&quot;) lines(df3$Q[df3$Type == &quot;AC&quot;], df3$Value[df3$Type == &quot;AC&quot;], col = &quot;purple&quot;, lwd = 2, lty = 1) lines(df3$Q[df3$Type == &quot;MC&quot;], df3$Value[df3$Type == &quot;MC&quot;], col = &quot;pink&quot;, lwd = 2, lty = 2) lines(df3$Q[df3$Type == &quot;MR&quot;], df3$Value[df3$Type == &quot;MR&quot;], col = &quot;skyblue&quot;, lwd = 2, lty = 4) legend(&quot;topright&quot;, legend = c(&quot;AC&quot;, &quot;MC&quot;, &quot;MR&quot;), col = c(&quot;purple&quot;, &quot;pink&quot;, &quot;skyblue&quot;), lwd = c(2, 2, 2), lty = c(1, 2, 4)) print(p3.1) ## NULL i. y_max1 was created as a new object for our y-axis. ii. Similar to the plot before, we create an empty plot with Q set for our x-axis and Value set for our y-axis. iii. We have similar lines(...) except for the MR which has lty=4 for a DotDash line. iv. Again, we manually add the legend unlike ggplot2 MR usually starts equal to price at Q=0 and slopes downward faster than demand. MC and AC are cost curves Where MR=MC, the profit-maximizing quantity occurs 4. Multiple Functions in one plot (FC, Price, MR, MC, AC) We have multiple functions now! Take note that Fixed Cost (FC) is constant; Break-Even is where Price=AC while Profit is: \\(\\pi(Q) = TR - TC\\) pi is \\pi a. Define the functions FC&lt;- 20 FC is a constant, assuming it is 20. For Profit, we need to get the profit for any level of output Q, not Q_vals because we want the function to accept any Q. b. Prepare the Data df_all&lt;-data.frame( Q=rep(Q_vals,5), Value=c(MC(Q_vals), AC(Q_vals), MR(Q_vals), rep(FC, length(Q_vals)), P(Q_vals)), Type = rep(c(&quot;MC&quot;, &quot;AC&quot;, &quot;MR&quot;, &quot;FC&quot;, &quot;Price&quot;), each = length(Q_vals)) ) #Check using View(df_all) In creating the data frame, the unique thing here is the FC, since it is constant and we want to see a long horizontal line, the value of FC carries over from 0 to 50 as 20. c. Plot All Functions ggplot(df_all, aes(x = Q, y = Value, color = Type, linetype = Type, size = Type)) + geom_line() + scale_color_manual(values = c(&quot;MC&quot;=&quot;red&quot;, &quot;AC&quot;=&quot;purple&quot;, &quot;MR&quot;=&quot;blue&quot;, &quot;FC&quot;=&quot;orange&quot;, &quot;Price&quot;=&quot;black&quot;)) + scale_linetype_manual(values = c(&quot;MC&quot;=&quot;dotdash&quot;, &quot;AC&quot;=&quot;dashed&quot;, &quot;MR&quot;=&quot;dotdash&quot;, &quot;FC&quot;=&quot;solid&quot;, &quot;Price&quot;=&quot;solid&quot;)) + scale_size_manual(values = c(&quot;MC&quot;=1.5, &quot;AC&quot;=1.2, &quot;MR&quot;=1.5, &quot;FC&quot;=1, &quot;Price&quot;=1)) + labs(title = &quot;MC, AC, MR, FC, Price Curves&quot;, x = &quot;Q&quot;, y = &quot;Cost / Revenue&quot;) + coord_cartesian(ylim=c(0, 150)) + theme_minimal() Base R Plotting plot(Q_vals, MC(Q_vals), type=&quot;l&quot;, col=&quot;red&quot;, lty=6, lwd=2, xlab=&quot;Q&quot;, ylab=&quot;Cost / Revenue&quot;, ylim=c(0,150), main=&quot;MC, AC, MR, FC, Price Curves&quot;) lines(Q_vals, AC(Q_vals), col=&quot;purple&quot;, lty=2, lwd=2) lines(Q_vals, MR(Q_vals), col=&quot;blue&quot;, lty=6, lwd=2) lines(Q_vals, rep(FC, length(Q_vals)), col=&quot;orange&quot;, lty=1, lwd=2) lines(Q_vals, P(Q_vals), col=&quot;black&quot;, lty=1, lwd=2) legend(&quot;topright&quot;, legend=c(&quot;MC&quot;,&quot;AC&quot;,&quot;MR&quot;,&quot;FC&quot;,&quot;Price&quot;), col=c(&quot;red&quot;,&quot;purple&quot;,&quot;blue&quot;,&quot;orange&quot;,&quot;black&quot;), lty=c(6,2,6,1,1), lwd=c(2,2,2,2,2)) Saving the Plots for Copy-Paste in Word/Google Docs for ggplot ggsave( filename = &quot;TC_plot.png&quot;, plot = p1, width = 7, height = 5, dpi = 300 ) We use ggsave to save our plot, filename is the name of the file, plot is the plot we want to save, width, height size in inches, dpi=300 is the print-quality resolution (keep this as is!) 7.1 Interpretation Guide: MC = MR This is the profit-maximizing quantity. Price &gt; AC Firm is making a profit Price &lt; AC Firm incurs a loss Intersection of AC and Price This is the break-even point AC above Price Helps identify economies of scale; meaning, check if firm has to increase production to reduce AC. 7.2 Mini-Exercise 2.1 Differentiate the following: a. \\(h(x) = 2x^{1/8} + 10\\) b. \\(C(\\gamma) = \\gamma^{1+ln(\\gamma)}+ln(\\gamma)\\) c. \\(f(\\theta) = \\sqrt{\\sqrt{\\sqrt{\\sqrt{\\theta+1}}}}\\) d. \\(f(x)=8x^7+7x^6+6x^5+5x^4+4x^3+3x^2+2x+1\\) (Until 5th order) A firm faces the total revenue \\(TR = 135Q - Q^2\\) a. Find MR in terms of Q b. What are TR and MR if Q is 45? c. If \\(TC = 0.5Q^2 + 5Q + 550\\) What is MC and AC? d. What are TC, MC, and AC if Q is 45? From MR in B.2. and MC in C.2., what can you say about the firm’s profit? Should they produce more? Using TR and TC from the previous numbers, Visualize the MR, MC, and AC curves in one plot; a. Q_vals should be until 60 b. MC should be Dashed and the favorite color of Partner A. c. MR should be DotDashed and color should be the favorite color of Partner B. d. AC should be Solid Thick line and color is Partner A + Partner B combined. d. Label the axes; y-axis as Cost/Revenue; x-axis as Quantity (Q) e. Label the plot as “MC, AC, and MR Curves” At what point do you see is the profit-maximizing quantity? "],["partial-derivatives.html", "8 Partial Derivatives 8.1 Cobb-Douglas Production Function 8.2 Utility Function 8.3 Exercise 3", " 8 Partial Derivatives rm(list=ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 2537735 135.6 4995202 266.8 3896772 208.2 ## Vcells 5334527 40.7 12255594 93.6 10146329 77.5 8.1 Cobb-Douglas Production Function \\(Q(L,K) = L^\\alpha * K^\\beta\\) Q(L,K) = L^\\alpha * K^\\beta We have to specify that the coefficients, \\(\\alpha\\) and \\(\\beta\\) be treated as constants to get the right differential. cd_pf&lt;- \\(L, K, alpha, beta) L^alpha * K^beta We define our production function 8.1.0.1 Partial Derivatives: Marginal Products Marginal Product of Labor is the additional output produced by one more unit of labor, holding capital constant. mpl&lt;-Deriv(cd_pf, &quot;L&quot;) mpl ## function (L, K, alpha, beta) ## alpha * K^beta * L^(alpha - 1) Marginal Product of Capital is the additional output produced by one more unit of capital, holding labor constant mpk&lt;-Deriv(cd_pf, &quot;K&quot;) mpk ## function (L, K, alpha, beta) ## beta * K^(beta - 1) * L^alpha Let us evaluate at specific values: \\(L=5, K=2, \\alpha=0.25, \\beta=0.75\\) L&lt;-5 K&lt;-2 alpha&lt;-0.25 beta&lt;-0.75 mpl(L,K,alpha,beta) #Value of MPL ## [1] 0.1257433 mpk(L,K,alpha,beta) #Value of MPK ## [1] 0.9430751 cd_pf(L,K, alpha,beta) #Total output Q ## [1] 2.514867 Interpretation: MPL tells how much output increases if you add one more unit of labor while keeping capital constant. MPK tells how much output increases if you add one more unit of capital while keeping labor constant. Q(L,K) gives total output at these input levels. 8.2 Utility Function Say we have the following utility function: \\(U(x,y) = x^{\\gamma}y^{\\delta}\\) U(x,y) = x^{\\gamma}y^{\\delta} where gamma is 0.35 and delta is 0.65 gamma&lt;-0.35 delta&lt;-0.65 Uxy&lt;-function(x, y) x^gamma*y^delta 8.2.0.1 Partial Derivatives: Marginal Utilities MUx&lt;-Deriv(Uxy, &quot;x&quot;) MUx ## function (x, y) ## gamma * x^(gamma - 1) * y^delta MUy&lt;-Deriv(Uxy, &quot;y&quot;) MUy ## function (x, y) ## delta * x^gamma * y^(delta - 1) Let us say x=5 and y=2 x&lt;-5 y&lt;-2 MUx(x,y) ## [1] 0.1929332 MUy(x,y) ## [1] 0.8957614 Uxy(x,y) ## [1] 2.756189 Interpretation: MUx tells how much utility increases if you consume one more unit of X while holding Y constant. MUy tells how much utility increases if you consume one more unit of Y while holding X constant. U(x,y) gives total satisfaction at these consumption levels 8.3 Exercise 3 I. Jem owns a milk tea stand that produces milk tea according to: \\(Q=X^{0.6}Y^{0.4}\\) where X = liters of milk tea and Y = scoops of boba Find \\(\\frac{\\partial Q}{\\partial X}\\) and \\(\\frac{\\partial Q}{\\partial Y}\\) If X = 10 liters of milk tea and Y = 3 scoops of boba, calculate the values of these partial derivatives Explain what each partial derivative shows about how output changes if you increase milk tea or boba Imagine Jem transferred ownership of the milk tea stand to you. Give an example of how knowing the partial derivatives helps you plan daily milk tea and boba use. II. Marie enjoys the drinks from Jem’s milk tea stand: \\(U = X^{0.2}Y^{0.8}\\) where X = cups of fruit tea based drink and Y = cups of milk tea drink Find \\(\\frac{\\partial U}{\\partial X}\\) and \\(\\frac{\\partial U}{\\partial Y}\\) If Marie bought the following: X = 5 cups of fruit tea drinks and Y= 2 cups of milk tea, calculate the values of these partial derivatives. Explain what each partial derivative means in terms of satisfaction from one more cup of each drink. You are now thinking of buying drinks from Jem’s milk tea stand; explain how Marie’s utility, helps you decide how many fruit tea based drinks and milk tea drinks to consume to feel satisfied. "],["answer-key.html", "9 Answer Key 9.1 Introduction 9.2 Weekly Exercise 1 9.3 Weekly Exercise 2 9.4 Weekly Exercise 2.1", " 9 Answer Key 9.1 Introduction Here are the final answers for the previous Weekly Exercises. These are combinations of the codes on how to write the Final Answers and the R codes. This will be particularly useful when you do your Problem Sets. However, this is the only time I will provide this Answer Key. For the succeeding topics/weekly exercises, no answer key will be given. 9.2 Weekly Exercise 1 9.2.1 Final Answers I will place what you put within the $$. f’(x) = 0 f’(x)=4x^3 f’(x)=44x^3 f’(x)=2x+5 f’(x)= 2x-10 C’(q) = 3q^2-8q+6 f’(x)=2e^{2x} f’(x)=\\frac{2}{x} R’(q)=20-4q AC’(q) = 10q-20 AP’(L) = 10-2L f’(x) = 9.2.2 R Codes \\(f(x)=101314\\) D(expression(101314), &quot;x&quot;) ## [1] 0 \\(f(x)=x^4\\) D(expression(x^4),&quot;x&quot;) ## 4 * x^3 \\(f(x)=11x^4\\) D(expression(11*x^4), &quot;x&quot;) ## 11 * (4 * x^3) Aside from you calculating the final answer, another option is to install and load the Ryacas package and use Simplify if(!(&quot;Deriv&quot; %in% installed.packages()[,&quot;Package&quot;])) install.packages(&quot;Deriv&quot;) library(Deriv) 9.2.2.0.1 If Using Simplify from Deriv : Create an object for the equation we differentiate. fx2&lt;-D(expression(11*x^4), &quot;x&quot;) Create an object so we can transform the answer into an expression. fx2_s&lt;-as.expression(fx2) Use the Simplify; there might be other Simplify from other packages so we will use this formation: package::command Deriv::Simplify(fx2_s) ## expression(44 * x^3) \\(f(x) = x^2+5x-9\\) D(expression(x^2 + 5*x - 9), &quot;x&quot;) ## 2 * x + 5 \\(f(x) = x^2-10x+20\\) D(expression(x^2 - 10*x + 20), &quot;x&quot;) ## 2 * x - 10 \\(C(q)=q^3 - 4q^2 + 6q+50\\) D(expression(q^3 - 4*q^2 + 6*q + 50), &quot;q&quot;) ## 3 * q^2 - 4 * (2 * q) + 6 \\(f(x)=e^{2x}\\) fx7&lt;-D(expression(exp(2*x)), &quot;x&quot;) exp is the “e” we see in the equation. fx7_s&lt;-as.expression(fx7) Deriv::Simplify(fx7_s) ## expression(2 * exp(2 * x)) Everything inside exp() is in the exponent. Outside, you multiply. So final answer is \\(2e^{2x}\\) \\(f(x)=ln(3x^2)\\) fx8&lt;-D(expression(log(3*x^2)), &quot;x&quot;) fx8_s&lt;-as.expression(fx8) Deriv::Simplify(fx8_s) ## expression(2/x) \\(R(q)=q(20-2q)\\) D(expression(q*(20 - 2*q)), &quot;q&quot;) ## (20 - 2 * q) - q * 2 \\(AC(q)=5q^2+20q\\) D(expression(5*q^2 + 20*q), &quot;q&quot;) ## 5 * (2 * q) + 20 Total Product \\(TP(L)=10L^2 -L^3\\) a. Get AP(L) \\(\\frac{TP(L)}{L}\\) \\(AP(L)=\\frac{10L^2 - L^3}{L}\\) fx11&lt;-D(expression((10*L^2 - L^3)/L), &quot;L&quot;) fx11_s&lt;-as.expression(fx11) Deriv::Simplify(fx11_s) ## expression(10 - 2 * L) \\(f(x)=ln(1+x^3)\\) fx12&lt;-D(expression(log(1 + x^3)), &quot;x&quot;) fx12_s&lt;-as.expression(fx12) Deriv::Simplify(fx12_s) ## expression(3 * (x^2/(1 + x^3))) 9.3 Weekly Exercise 2 9.3.1 Final Answers I will put what is written between $$ h’(x)=\\frac{4}{7x^{\\frac{5}{7}} f’(\\theta) = + 1 + 2\\theta e^{\\theta^2} f’(\\gamma) = OR f’(\\gamma) = f^(6)(x) = 40320x+5040 MR=125-2Q TR(40) = 3400; MR(40)= 45 MC = 5+Q; AC = TC(40)= 1500; MC(40)= 45; AC(40)= 37.5; ggplot2: Base R: 9.3.2 R Codes 9.3.2.1 Preliminaries 9.3.2.1.1 Cleaning Environment rm(list=ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 2537845 135.6 4995202 266.8 3948100 210.9 ## Vcells 5335007 40.8 12255594 93.6 10146329 77.5 9.3.2.1.2 Pre-plotting Check user &lt;- file.path(Sys.getenv(&quot;USERPROFILE&quot;), &quot;R&quot;, &quot;win-library&quot;, &quot;4.5&quot;) dir.create(user, recursive = TRUE, showWarnings = FALSE) .libPaths(c(user, .libPaths())) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) if (!ok) { install.packages(&quot;rlang&quot;, lib = user_lib) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) } if (!ok) plot(1:5, rnorm(5)) If ok Values turn out to be TRUE, you can use ggplot2. If ok Values turn out to be FALSE, you use Base R plotting. 9.3.2.1.3 Load Libraries library(Deriv) library(ggplot2) library(MASS) \\(h(x) = 2x^{\\frac{2}{7}}+9\\) hx&lt;-\\(x) 2*x^(2/7)+9 Dhx&lt;-Deriv(hx, &quot;x&quot;) Dhx ## function (x) ## 0.571428571428571/x^0.714285714285714 You can present this as decimals or fractions. You can use MASS::fractions() to get the fractions MASS::fractions(0.571428571428571) ## [1] 4/7 MASS::fractions(0.714285714285714) ## [1] 5/7 \\(f(\\theta) = ln(\\theta)+e^{\\theta^2}+e^{ln(\\theta)}\\) ftheta&lt;-\\(theta) log(theta)+exp(theta^2)+exp(log(theta)) Dftheta&lt;-Deriv(ftheta,&quot;theta&quot;) Dftheta ## function (theta) ## (1 + exp(log(theta)))/theta + 2 * (theta * exp(theta^2)) Writing the expression: \\(\\frac{1+exp(log(\\theta))}{\\theta} + 2 \\cdot (\\theta \\cdot exp(\\theta^2))\\) Always remember: \\(exp(log(x))=x\\) because exp() and log() are inverse functions, so: \\(\\frac{1+\\theta}{\\theta}+ 2 \\cdot (\\theta \\cdot exp(\\theta^2))\\) Remember your algebra. Now, we have: \\(\\frac{1}{\\theta} + 1 + 2\\theta e^{\\theta^2}\\) \\(f(\\gamma)=\\sqrt{\\sqrt{\\sqrt{\\sqrt{\\sqrt{\\gamma+1}}}}}\\) Reduce(&#39;*&#39;, rep(1/2, 5)) ## [1] 0.03125 fgamma&lt;-\\(gamma) (gamma+1)^0.03125 Dfgamma&lt;-Deriv(fgamma, &quot;gamma&quot;) Dfgamma ## function (gamma) ## 0.03125/(1 + gamma)^0.96875 MASS::fractions(0.03125) ## [1] 1/32 MASS::fractions(0.96875) ## [1] 31/32 \\(f(x)=8x^7+7x^6+6x^5+5x^4+4x^3+3x^2+2x+1\\) (6th order) fx6&lt;-\\(x) 8*x^7+7*x^6+6*x^5+5*x^4+4*x^3+3*x^2+2*x+1 Dfx6&lt;-Deriv(fx6, &quot;x&quot;, nderiv=6) Dfx6 ## function (x) ## 40320 * x + 5040 II. A firm faces the total revenue \\(TR=125Q-Q^2\\) a. Find MR in terms of Q TR&lt;- \\(Q) 125*Q-Q^2 MR&lt;-Deriv(TR,&quot;Q&quot;) MR ## function (Q) ## 125 - 2 * Q b. What are TR and MR if Q is 40? TR(40) ## [1] 3400 MR(40) ## [1] 45 c. If \\(TC=0.5Q^2+5Q+500\\), what is MC and AC? TC&lt;- \\(Q) 0.5*Q^2+5*Q+500 MC&lt;-Deriv(TC, &quot;Q&quot;) MC ## function (Q) ## 5 + Q AC&lt;- \\(Q) TC(Q)/Q AC ## function (Q) ## TC(Q)/Q OR AC2&lt;- \\(Q) 0.5*Q^2+5*Q+500/Q AC2 ## function (Q) ## 0.5 * Q^2 + 5 * Q + 500/Q d. What are TC, MC, and AC if Q is 40? TC(40) ## [1] 1500 MC(40) ## [1] 45 AC(40) ## [1] 37.5 III. Using TR and TC from previous numbers, Visualize the MR, MC, and AC in one plot; a. Q_vals should be until 50 b. MC should be Dashed c. MR should be DotDashed d. AC should be Solid Thick line e. Label the axes; f. Label as “MC, AC, and MR Curves” 9.3.2.1.4 ggplot Graph 9.3.2.1.4.1 Define the functions MC ## function (Q) ## 5 + Q MR ## function (Q) ## 125 - 2 * Q AC ## function (Q) ## TC(Q)/Q 9.3.2.1.4.2 Create Q_vals Q_vals&lt;-seq(0,50, length.out = 100) 9.3.2.1.4.3 Create Data Frame df1&lt;-data.frame( Q=rep(Q_vals,3), #need to repeat Q_vals 3 times to create our 3 curves/lines Value=c(MC(Q_vals), AC(Q_vals), MR(Q_vals)), #to &quot;incorporate&quot; the Q_vals to MC, AC, and MR Type= rep(c(&quot;MC&quot;, &quot;AC&quot;, &quot;MR&quot;), each=length(Q_vals)) ) Always check your data frame; should have 100 observations each for MC, AC and MR. p3&lt;-ggplot(df1, aes(x=Q, y=Value, color=Type, linetype = Type, size = Type))+ geom_line()+ scale_color_manual(values=c(&quot;MC&quot;=&quot;tomato&quot;, &quot;AC&quot; = &quot;magenta&quot;, &quot;MR&quot; = &quot;navy&quot;))+ scale_linetype_manual(values=c(&quot;MC&quot;=&quot;dashed&quot;, &quot;AC&quot;=&quot;solid&quot;, &quot;MR&quot;=&quot;dotdash&quot;))+ scale_size_manual(values=c(&quot;MC&quot;=1, &quot;AC&quot;=2, &quot;MR&quot;=1.5))+ labs(title = &quot;MC, AC, and MR Curves&quot;, x=&quot;Q&quot;, y=&quot;Cost/Revenue&quot;)+ coord_cartesian(ylim=c(0,100))+ theme_minimal() print(p3) ggsave( filename = &quot;MRACMC_plot.png&quot;, plot = p3, width = 7, height = 5, dpi = 300 ) You can copy the image and paste in Final Answers 9.3.2.1.5 Base R Graph 9.3.2.1.5.1 Define the functions MC AC MR 9.3.2.1.5.2 Create Q_values Q_base&lt;-seq(0,50, length.out = 100) 9.3.2.1.5.3 Prepare the data dfb&lt;-data.frame( Q=rep(Q_base,3), Value=c(MC(Q_base), AC(Q_base), MR(Q_base)), Type=rep(c(&quot;MC&quot;,&quot;AC&quot;,&quot;MR&quot;), each = length(Q_base)) ) y_min&lt;-0 y_max&lt;-100 #png(&quot;MRACMC_bplot.png&quot;, width= 700, height = 500) #to save in your directory p3b&lt;-plot(dfb$Q, dfb$Value, type = &quot;n&quot;, xlab = &quot;Q&quot;, ylab = &quot;Cost / Revenue&quot;, ylim = c(y_min, y_max), main = &quot;MC, AC, and MR Curves&quot;) lines(dfb$Q[dfb$Type == &quot;AC&quot;], dfb$Value[dfb$Type == &quot;AC&quot;], col = &quot;magenta&quot;, lwd = 2, lty = 1) lines(dfb$Q[dfb$Type == &quot;MC&quot;], dfb$Value[dfb$Type == &quot;MC&quot;], col = &quot;tomato&quot;, lwd = 2, lty = 2) lines(dfb$Q[dfb$Type == &quot;MR&quot;], dfb$Value[dfb$Type == &quot;MR&quot;], col = &quot;navy&quot;, lwd = 2, lty = 4) legend(&quot;topright&quot;, legend = c(&quot;AC&quot;, &quot;MC&quot;, &quot;MR&quot;), col = c(&quot;magenta&quot;, &quot;tomato&quot;, &quot;navy&quot;), lwd = c(2, 2, 2), lty = c(1, 2, 4)) #dev.off() #for plots to be saved properly You can also copy the image and paste in Final Answers 9.4 Weekly Exercise 2.1 9.4.1 Final Answers h’(x) = \\frac{1}{4(x^{\\frac{7}{8}} C’(\\gamma)=\\frac{1}{\\gamma}+\\gamma^{ln(\\gamma)}(1+2ln(\\gamma)) f’(\\theta)=\\frac{1}{16(1+\\theta)^{\\frac{15}{16}} f^(5)(x)=20160x^2+5040x+720 MR=135-2Q TR(45)= 4050; MR(45)=45 AC=\\frac{0.5Q^2+5Q+550}{Q} MC=5+Q TC(45)=1787.5 ; MC(45) = 50; AC(45)= 39.72 ggplot2: Base R: 9.4.2 R Codes 9.4.2.1 Preliminaries 9.4.2.1.1 Cleaning Environment rm(list=ls()) gc() ## used (Mb) gc trigger (Mb) max used (Mb) ## Ncells 2539482 135.7 4995202 266.8 4995202 266.8 ## Vcells 5337574 40.8 12255594 93.6 10146329 77.5 9.4.2.1.2 Pre-plotting Check user &lt;- file.path(Sys.getenv(&quot;USERPROFILE&quot;), &quot;R&quot;, &quot;win-library&quot;, &quot;4.5&quot;) dir.create(user, recursive = TRUE, showWarnings = FALSE) .libPaths(c(user, .libPaths())) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) if (!ok) { install.packages(&quot;rlang&quot;, lib = user_lib) ok &lt;- tryCatch({ library(ggplot2) ggplot(data.frame(x=1:5, y=rnorm(5)), aes(x,y)) + geom_point() TRUE }, error = function(e) FALSE) } if (!ok) plot(1:5, rnorm(5)) If ok Values turn out to be TRUE, you can use ggplot2. If ok Values turn out to be FALSE, you use Base R plotting. 9.4.2.1.3 Load Libraries library(Deriv) library(ggplot2) library(MASS) \\(h(x)=2x^{\\frac{1}{8}}+10\\) hx&lt;- \\(x) 2*x^(1/8)+10 dhx&lt;-Deriv(hx, &quot;x&quot;) dhx ## function (x) ## 0.25/x^0.875 MASS::fractions(0.25) ## [1] 1/4 MASS::fractions(0.875) ## [1] 7/8 \\(C(\\gamma)=\\gamma^{1+ln(\\gamma)}+ln(\\gamma)\\) cgamma&lt;-\\(gamma) gamma^(1+log(gamma))+log(gamma) dcgamma&lt;-Deriv(cgamma, &quot;gamma&quot;) dcgamma ## function (gamma) ## { ## .e1 &lt;- log(gamma) ## 1/gamma + gamma^.e1 * (1 + 2 * .e1) ## } Replace .e1 with log(gamma) so equation looks like this: \\(\\frac{1}{\\gamma}+\\gamma^{ln(\\gamma)}(1+2ln(\\gamma))\\) \\(f(\\theta)=\\sqrt{\\sqrt{\\sqrt{\\sqrt{\\theta+1}}}}\\) Reduce(&#39;*&#39;, rep(1/2,4)) ## [1] 0.0625 ftheta&lt;-\\(theta) (theta+1)^0.0625 dftheta&lt;-Deriv(ftheta,&quot;theta&quot;) dftheta ## function (theta) ## 0.0625/(1 + theta)^0.9375 MASS::fractions(0.0625) ## [1] 1/16 MASS::fractions(0.9375) ## [1] 15/16 \\(f(x)=8x^7+7x^6+6x^5+5x^4+4x^3+3x^2+2x+1\\) f5x&lt;-\\(x) 8*x^7+7*x^6+6*x^5+5*x^4+4*x^3+3*x^2+2*x+1 df5x&lt;-Deriv(f5x,&quot;x&quot;, nderiv=5) df5x ## function (x) ## 720 + x * (20160 * x + 5040) II. \\(TR=135Q-Q^2\\) a. TR&lt;-\\(Q) 135*Q-Q^2 MR&lt;- Deriv(TR, &quot;Q&quot;) MR ## function (Q) ## 135 - 2 * Q b. TR(45) ## [1] 4050 MR(45) ## [1] 45 c. \\(TC=0.5Q^2+5Q+550\\) TC&lt;-\\(Q) 0.5*Q^2+5*Q+550 MC&lt;-Deriv(TC,&quot;Q&quot;) MC ## function (Q) ## 5 + Q AC&lt;-\\(Q) TC(Q)/Q AC ## function (Q) ## TC(Q)/Q AC2&lt;-\\(Q) (0.5*Q^2+5*Q+550)/Q AC2 ## function (Q) ## (0.5 * Q^2 + 5 * Q + 550)/Q d. TC(45) ## [1] 1787.5 MC(45) ## [1] 50 AC(45) ## [1] 39.72222 IV. a. Q_vals should be until 60 b. MC should be Dashed c. MR should be DotDashed d. AC should be Solid Thick line d. Label the axes; y-axis as Cost/Revenue; x-axis as Quantity (Q) e. Label the plot as “MC, AC, and MR Curves” 9.4.2.1.4 ggplot Graph 9.4.2.1.4.1 Define the functions MC ## function (Q) ## 5 + Q AC ## function (Q) ## TC(Q)/Q MR ## function (Q) ## 135 - 2 * Q 9.4.2.1.4.2 Create Q_vals Q_vals&lt;-seq(0,60, length.out=100) 9.4.2.1.4.3 Create Data Frame df1&lt;-data.frame( Q=rep(Q_vals,3), #need to repeat Q_vals 3 times to create our 3 curves/lines Value=c(MC(Q_vals), AC(Q_vals), MR(Q_vals)), #to &quot;incorporate&quot; the Q_vals to MC, AC, and MR Type= rep(c(&quot;MC&quot;, &quot;AC&quot;, &quot;MR&quot;), each=length(Q_vals)) ) Always check your data frame; should have 100 observations each for MC, AC and MR. p3.2.1&lt;-ggplot(df1, aes(x=Q, y=Value, color=Type, linetype = Type, size = Type))+ geom_line()+ scale_color_manual(values=c(&quot;MC&quot;=&quot;tomato&quot;, &quot;AC&quot; = &quot;magenta&quot;, &quot;MR&quot; = &quot;navy&quot;))+ scale_linetype_manual(values=c(&quot;MC&quot;=&quot;dashed&quot;, &quot;AC&quot;=&quot;solid&quot;, &quot;MR&quot;=&quot;dotdash&quot;))+ scale_size_manual(values=c(&quot;MC&quot;=1, &quot;AC&quot;=2, &quot;MR&quot;=1.5))+ labs(title = &quot;MC, AC, and MR Curves&quot;, x=&quot;Q&quot;, y=&quot;Cost/Revenue&quot;)+ coord_cartesian(ylim=c(0,100))+ theme_minimal() print(p3.2.1) ggsave( filename = &quot;MRACMC_plot2.1.png&quot;, plot = p3.2.1, width = 7, height = 5, dpi = 300 ) You can copy the image and paste in Final Answers 9.4.2.1.5 Base R Graph 9.4.2.1.5.1 Define the functions MC AC MR 9.4.2.1.5.2 Create Q_values Q_b&lt;-seq(0,60, length.out=100) 9.4.2.1.5.3 Prepare the data dfb&lt;-data.frame(Q=rep(Q_b,3), Value=c(MC(Q_b), AC(Q_b), MR(Q_b)), Type=rep(c(&quot;MC&quot;,&quot;AC&quot;,&quot;MR&quot;), each = length(Q_b)) ) y_min&lt;-0 y_max&lt;-100 #png(&quot;MRACMC_bplot2.1.png&quot;, width= 700, height = 500) p3b.2.1&lt;-plot(dfb$Q, dfb$Value, type = &quot;n&quot;, xlab = &quot;Q&quot;, ylab = &quot;Cost / Revenue&quot;, ylim = c(y_min, y_max), main = &quot;MC, AC, and MR Curves&quot;) lines(dfb$Q[dfb$Type == &quot;AC&quot;], dfb$Value[dfb$Type == &quot;AC&quot;], col = &quot;magenta&quot;, lwd = 2, lty = 1) lines(dfb$Q[dfb$Type == &quot;MC&quot;], dfb$Value[dfb$Type == &quot;MC&quot;], col = &quot;tomato&quot;, lwd = 2, lty = 2) lines(dfb$Q[dfb$Type == &quot;MR&quot;], dfb$Value[dfb$Type == &quot;MR&quot;], col = &quot;navy&quot;, lwd = 2, lty = 4) legend(&quot;topright&quot;, legend = c(&quot;AC&quot;, &quot;MC&quot;, &quot;MR&quot;), col = c(&quot;magenta&quot;, &quot;tomato&quot;, &quot;navy&quot;), lwd = c(2, 2, 2), lty = c(1, 2, 4)) #dev.off() "],["review-of-derivatives-and-visualizations.html", "10 Review of Derivatives and Visualizations 10.1 Review of Visualizing Functions 10.2 Review of Partial Derivatives", " 10 Review of Derivatives and Visualizations 10.1 Review of Visualizing Functions 10.1.1 Linear Function A linear function increases or decreases at a constant rate. Example: Price-demand relationship (linear demand) \\(P(Q) = 100-2Q\\) Price decreases by 2 units for every unit of quantity 10.1.1.0.1 Define the function P&lt;- \\(Q) 100-2*Q 10.1.1.0.2 Next Steps: We already did this before: Q_vals&lt;-seq(0,50, length.out=100) df&lt;-data.frame(Q=Q_vals, P=P(Q_vals)) For now, we plot using Base R: plot(df$Q, df$P, type=&quot;l&quot;, col=&quot;darkgreen&quot;, lwd=2, main=&quot;Linear Demand Curve&quot;, xlab=&quot;Quantity&quot;, ylab=&quot;Price&quot;) We use line graph and a thicker line with labels. We see that price drops as quantity increases. 10.1.2 Quadratic Function Quadratic function has a curve and the slope changes. Example: Total Cost \\(TC(Q) = Q^2 - 10Q + 50\\) 10.1.2.0.1 Define the function TC&lt;- \\(Q) Q^2-10*Q+50 10.1.2.0.2 Next steps: df2&lt;-data.frame(Q=Q_vals, TC=TC(Q_vals)) plot(df2$Q, df2$TC, type=&quot;l&quot;, col=&quot;darkgreen&quot;, lwd=2, main=&quot;Total Cost Curve&quot;, xlab=&quot;Quantity&quot;, ylab=&quot;Cost&quot;) 10.1.3 Exponential Function Exponential grows/shrinks rapidly; Example: Compound growth of revenue \\(R(Q) = 50 * e^{0.05Q}\\) 10.1.3.0.1 Define the function R&lt;- \\(Q) 50*exp(0.05*Q) No need to do ^ since it is exponential. 10.1.3.0.2 Next Steps: df3&lt;- data.frame(Q=Q_vals, R=R(Q_vals)) plot(df3$Q, df3$R, type=&quot;l&quot;, col=&quot;tomato&quot;, lwd=2, main=&quot;Exponential Revenue Growth&quot;, xlab=&quot;Quantity&quot;, ylab=&quot;Revenue&quot;) Revenue grows faster with more quantity due to compounding effect or price increase per unit sold. 10.2 Review of Partial Derivatives Partial derivatives show how a function changes if we change one variable while keeping others fixed. rm(list=ls()) 10.2.1 Production Function \\(Q(L,K) = L^{0.5} K^{0.5}\\) 10.2.1.0.1 Define the function pf&lt;- \\(L,K) L^0.5*K^0.5 10.2.1.0.2 Partial Derivatives library(Deriv) mpl&lt;-Deriv(pf,&quot;L&quot;) mpk&lt;-Deriv(pf, &quot;K&quot;) 10.2.1.0.3 Evaluate at L=7, K=11 L&lt;-7 K&lt;-11 mpl(L,K) ## [1] 0.6267832 mpk(L,K) ## [1] 0.398862 Marginal Product of Labor is the extra output per extra unit of labor while Marginal Product of Capital is the extra output per extra unit of capital. If you want to get actual output change, multiply by dL 10.2.2 Utility Function \\(U = x^{0.3}*y^{0.7}\\) 10.2.2.0.1 Define the function U&lt;- \\(x,y) x^0.3*y^0.7 10.2.2.0.2 Next Steps: mux&lt;-Deriv(U, &quot;x&quot;) muy&lt;-Deriv(U, &quot;y&quot;) #Evaluate at x=5, y=3 mux(5,3) ## [1] 0.2098105 muy(5,3) ## [1] 0.8159296 MUx is the extra satisfaction from 1 more unit of x while MUy is the extra satisfaction from 1 more unit of y 10.2.3 Profit Function \\(\\pi(Q_1, Q_2) = 50Q_1+80Q_2-Q_1^2-2Q_2^2\\) write: \\pi(Q_1, Q_2) = 50Q_1+80Q_2-Q_1^2-2Q_2^2 10.2.3.0.1 Define the function pi&lt;- \\(Q1,Q2) 50*Q1+80*Q2-Q1^2-2*Q2^2 10.2.3.0.2 Next Steps: dpi_dq1&lt;-Deriv(pi, &quot;Q1&quot;) dpi_dq2&lt;-Deriv(pi, &quot;Q2&quot;) #Evaluate at Q1=5, Q2=4 dpi_dq1(5,4) ## [1] 40 dpi_dq2(5,4) ## [1] 64 Change in profit if producing one more unit of Q1 or Q2 10.2.4 Revenue Function \\(R(Q_1,Q_2) = 20Q_1+30Q_2\\) 10.2.4.0.1 Define the function rf&lt;- \\(Q1,Q2) 20*Q1+30*Q2 10.2.4.0.2 Next Steps: #We combine the partial derivatives and evaluation Deriv(rf,&quot;Q1&quot;)(10,5) ## [1] 20 Deriv(rf, &quot;Q2&quot;)(10,5) ## [1] 30 10.2.5 Cost Function \\(C(Q_1, Q_2) = 5Q_1^2+3Q_2^2+10\\) 10.2.5.0.1 Define the function cf&lt;- \\(Q1,Q2) 5*Q1^2+30*Q2 10.2.5.0.2 Next Steps Deriv(cf, &quot;Q1&quot;)(7,8) ## [1] 70 Deriv(cf, &quot;Q2&quot;)(7,8) ## [1] 30 "],["total-differentiation-youngs-theorem-hessian-matrix-and-bordered-hessian-matrix.html", "11 Total Differentiation, Young’s Theorem, Hessian Matrix and Bordered Hessian Matrix 11.1 Total Differentiation 11.2 Young’s Theorem 11.3 Hessian Matrix 11.4 Bordered Hessian 11.5 Example 1 11.6 Interpretations: 11.7 Exercise:", " 11 Total Differentiation, Young’s Theorem, Hessian Matrix and Bordered Hessian Matrix 11.1 Total Differentiation Total differentiation gives total change when all inputs change: \\(dQ = MPL*dL+MPK*dK\\) 11.1.1 Cobb-Douglas Production Function L&lt;-4; K&lt;-9; dL&lt;-1; dK&lt;-2 dq&lt;-mpl(L,K)*dL+mpk(L,K)*dK dq ## [1] 1.416667 We used the mpl and mpk calculated before. The result is the total output change from both labor and capital changes. 11.1.2 Profit Function dQ1&lt;-2; dQ2&lt;-1 dpi&lt;- dpi_dq1(5,4)*dQ1+dpi_dq2(5,4)*dQ2 dpi ## [1] 144 Shows total profit change from increasing both products 11.2 Young’s Theorem Suppose we have a function with two variables: \\(f(x,y)\\) We can take derivatives in different orders: Differentiate by \\(x\\), then \\(y\\) \\(\\frac{\\partial^2f}{\\partial y \\partial x}\\) OR Differentiate by \\(y\\), then \\(x\\) \\(\\frac{\\partial^2f}{\\partial x \\partial y}\\) Young’s Theorem says that if the function is smooth (continuous derivatives), \\(f_{xy} = f_{yx}\\) Then the order of differentiation does not matter. In economics, cross partial derivative measures how one variable affects the marginal effect of another. Example, utility, the cross derivative tells you how consuming more \\(y\\) changes marginal utility of \\(x\\). 11.2.1 Utility Function \\(U(x,y) = x^{0.5} y^{0.5}\\) rm(list=ls()) 11.2.1.0.1 Define the function U&lt;- \\(x,y) x^0.5*y^0.5 11.2.1.0.2 First partial derivative with respect to X ux&lt;-Deriv(U,&quot;x&quot;) We computed here the derivative wrt x 11.2.1.0.3 Cross partial derivative (x then y) uxy&lt;-Deriv(ux,&quot;y&quot;) Takes derivative again, now wrt y 11.2.1.0.4 First partial derivative with respect to Y uy&lt;-Deriv(U,&quot;y&quot;) We did the same, this time wrt y 11.2.1.0.5 Cross partial derivative (y then x) uyx&lt;-Deriv(uy,&quot;x&quot;) Take derivative again wrt to x 11.2.1.0.6 Check if identical identical(uxy, uyx) ## [1] TRUE We compare the expression. IF TRUE, Young’s theorem holds. If FALSE, Young’s theorem doesn’t. 11.2.2 Production Function \\(Q(L,K) = L^{0.6}K^{0.4}\\) The cross derivative shows how adding more capital affects marginal productivity of labor. 11.2.2.0.1 Define the function Q&lt;- \\(L,K) L^0.6*K^0.4 11.2.2.0.2 Next Steps: Unlike before where we did each step separately, the next code chunk shows how we combine the steps. qlk&lt;-Deriv(Deriv(Q,&quot;L&quot;), &quot;K&quot;) qkl&lt;-Deriv(Deriv(Q, &quot;K&quot;), &quot;L&quot;) identical(qlk, qkl) ## [1] TRUE What happens in the code is that the code inside the parenthesis will be conducted first, followed by the one outside. So, Deriv(Deriv(1), 2) 11.2.3 Profit Interaction \\(\\pi(Q_1,Q_2) = 50Q_1+80Q_2-Q_1^2-2Q_2^2+3Q_1Q_2\\) The interaction term, \\(3Q_1Q_2\\) looks at how producing one good affects marginal profit of another. 11.2.3.0.1 Define the function pi&lt;-\\(q1,q2) 50*q1+80*q2-q1^2-22*q2^2+3*q1*q2 11.2.3.0.2 Next Steps p_q1q2&lt;-Deriv(Deriv(pi,&quot;q1&quot;), &quot;q2&quot;) p_q2q1&lt;-Deriv(Deriv(pi, &quot;q2&quot;), &quot;q1&quot;) identical(p_q1q2, p_q2q1) ## [1] TRUE 11.2.4 Cost Interaction \\(C(x,y) = 4x^2+3y^2+xy\\) 11.2.4.0.1 Define the Function C&lt;-\\(x,y) 4*x^2+3*y^2+x*y 11.2.4.0.2 Next Steps: Unlike before, we now combine the codes as one so that the output is simply whether Young’s Theorem holds or not: identical(Deriv(Deriv(C,&quot;x&quot;),&quot;y&quot;), Deriv(Deriv(C,&quot;y&quot;),&quot;x&quot;)) ## [1] TRUE 11.3 Hessian Matrix The Hessian is the matrix of second partial derivatives. For: \\(f(x,y)\\) 11.3.0.1 Structure of Hessian To write inline, put what is in the code chunk below. H = \\begin{bmatrix} f_{xx} &amp; f_{xy} \\\\ #\\\\ for new row f_{yx} &amp; f_{yy} \\end{bmatrix} \\(H = \\begin{bmatrix} f_{xx} &amp; f_{xy} \\\\ f_{yx} &amp; f_{yy} \\end{bmatrix}\\) Economically, the Hessian tells the maximum, minimum and saddle point. Let’s look at the meaning of each part of the matrix: \\(f_{xx}\\) = curvature in \\(x\\) direction \\(f_{yy}\\) = curvature in \\(y\\) direction \\(f_{xy}, f_{yx}\\) = cross effects (interaction curvature) Young’s Theorem is important here because the Hessian becomes symmetric with Young’s Theorem. 11.3.1 Decision Rule (2 variables) Compute: \\(D=f_{xx}f_{yy}-(f_{xy})^2\\) If \\(D&gt;0\\) and \\(f_{xx}&gt;0\\), local minimum This is showing cost minimization If \\(D&gt;0\\) and \\(f_{xx}&lt;0\\), local maximum This is showing profit or utility maximization If \\(D&lt;0\\), saddle point shows unstable equilibrium 11.3.2 Local Minimum \\(f(x,y) = x^2+y^2\\) 11.3.2.0.1 Define the function rm(list=ls()) f&lt;-\\(x,y) x^2+y^2 11.3.2.0.2 First derivatives fx&lt;-Deriv(f,&quot;x&quot;) fy&lt;-Deriv(f,&quot;y&quot;) Marginal effects 11.3.2.0.3 Second derivatives fxx&lt;-Deriv(fx,&quot;x&quot;) fyy&lt;-Deriv(fy, &quot;y&quot;) fxy&lt;-Deriv(fx, &quot;y&quot;) #fxy=fyx through Young&#39;s Theorem Creates curvature measures 11.3.2.0.4 Evaluate at critical point (0,0) fxx_0&lt;-fxx(0,0) fyy_0&lt;-fyy(0,0) fxy_0&lt;-fxy(0,0) 11.3.2.0.5 Construct Hessian H&lt;-matrix(c( fxx_0, fxy_0, fxy_0, fyy_0 ), nrow = 2) H ## [,1] [,2] ## [1,] 2 0 ## [2,] 0 2 11.3.2.0.6 Making the Matrix H = \\begin{bmatrix}2 &amp; 0 \\\\0 &amp; 2\\end{bmatrix} \\(H=\\begin{bmatrix}2&amp;0\\\\0&amp;2\\end{bmatrix}\\) matrix() arranges the values we calculated to a matrix c() to include collectively what are inside the parenthesis nrow=2 provides the number of rows in the matrix 11.3.2.0.7 Compute determinant det_H&lt;-det(H) det_H ## [1] 4 11.3.2.0.8 Interpretation You can include this, or you can simply look at det_H and fxx_0. ch&lt;-function(det_H, fxx_0){ if(det_H &gt; 0 &amp; fxx_0 &gt; 0){ return(&quot;Local Minimum&quot;) } else if (det_H &gt; 0 &amp; fxx_0 &lt; 0){ return(&quot;Local Maximum&quot;) } else if (det_H &lt; 0){ return(&quot;Saddle Point&quot;) } else {return(&quot;Inconclusive&quot;)} } function(){} creates a reusable function. It checks what is inside the parenthesis then looks at the conditions you set. if(condition){} tells R whether condition is TRUE det_H&gt;0 condition checking &amp; is to check if both conditions are TRUE else if if first condition fails, check next condition else if all conditions fail return reveals what the answer is ch(det_H, fxx_0) ## [1] &quot;Local Minimum&quot; 11.3.3 Function 2 \\(C(Q_1,Q_2) = Q_1^2+Q_2^2\\) 11.3.3.0.1 Next Steps: Try in class You might be wondering where the 0,0 comes from. This is when we want to evaluate the curvature at a specific point. In this case, it is 0,0 - the critical point. If you want to know the curvature near production bundle (5 for Q1, 3 for Q2), simply change (0,0) 11.3.4 Function 3 \\(\\pi(x,y) = -x^2-y^2\\) 11.3.4.0.1 Next Steps: Try in class 11.3.5 Function 4 \\(C=x^2+y^2+xy\\) 11.3.5.0.1 Next Steps: Try in class 11.4 Bordered Hessian The Bordered Hessian is a matrix used to test whether a constrained optimization problem gives maximum, minimum, or saddle point. It is used when you optimize WITH a constraint. Without constraint: Hessian With constraint: bordered Hessian The constraint changes the curvature analysis and we must include how Lagrange multiplier interacts with variables 11.4.0.1 Setup: Suppose Objective function is \\(f(x,y)\\) Constraint is: \\(g(x,y)=0\\) Lagrangian \\(\\mathcal{L} = f(x,y)+ \\lambda g(x,y)\\) \\mathcal{L} = f(x,y)+ \\lambda g(x,y) 11.4.0.2 Structure of Bordered Hessian Two variables: In the code chunk, you place this in your inline Math BH = \\begin{bmatrix} 0 &amp; g_x &amp; g_y \\\\ g_x &amp; \\mathcal{L}_{xx} &amp; \\mathcal{L}_{xy} \\\\ g_y &amp; \\mathcal{L}_{yx} &amp; \\mathcal{L}_{yy} \\end{bmatrix} \\(BH = \\begin{bmatrix} 0 &amp; g_x &amp; g_y \\\\ g_x &amp; \\mathcal{L}_{xx} &amp; \\mathcal{L}_{xy} \\\\ g_y &amp; \\mathcal{L}_{yx} &amp; \\mathcal{L}_{yy} \\end{bmatrix}\\) Top-left is always zero First row/column are the gradient of constraint; how constraint changes when variables change Lower right block is the second derivatives of Lagrangian 11.4.1 Setup Example: \\(f(x,y)=\\sqrt{x}\\sqrt{y}\\) Constraint: \\(100-10x-20y=0\\) Lagrangian \\(\\mathcal{L}=\\sqrt{x}\\sqrt{y} + \\lambda(100-10x-20y)\\) 11.4.1.0.1 Install and Load Packages if(!require(nleqslv)) install.packages(&quot;nleqslv&quot;) library(nleqslv) 11.4.1.0.2 Define functions fxy&lt;-\\(x,y) x^(0.5)*y^(0.5) cons&lt;- \\(x,y) 100-10*x-20*y 11.4.1.0.3 Set up Lagrangian Lg&lt;- \\(x,y,lambda) fxy(x,y)+lambda*cons(x,y) 11.4.1.0.4 First Order Conditions Lx&lt;-Deriv(Lg,&quot;x&quot;) Ly&lt;-Deriv(Lg,&quot;y&quot;) Llambda&lt;-Deriv(Lg,&quot;lambda&quot;) #View for later Lx ## function (x, y, lambda) ## 0.5 * (sqrt(y)/sqrt(x)) - 10 * lambda Ly ## function (x, y, lambda) ## 0.5 * (sqrt(x)/sqrt(y)) - 20 * lambda Llambda ## function (x, y, lambda) ## cons(x, y) These give optimality conditions 11.4.1.0.5 Solve for optimal bundle f &lt;- function(v){ x &lt;- v[1] y &lt;- v[2] lambda &lt;- v[3] c( 0.5*sqrt(y)/sqrt(x) - 10*lambda, 0.5*sqrt(x)/sqrt(y) - 20*lambda, 10*x + 20*y - 100 ) } nleqslv(c(1,1,0.1), f) ## $x ## [1] 5.00000000 2.50000000 0.03535534 ## ## $fvec ## [1] 0.000000000009564793 -0.000000000013307022 0.000000000000000000 ## ## $termcd ## [1] 1 ## ## $message ## [1] &quot;Function criterion near zero&quot; ## ## $scalex ## [1] 1 1 1 ## ## $nfcnt ## [1] 8 ## ## $njcnt ## [1] 1 ## ## $iter ## [1] 6 f&lt;-function(v){...} creates a function with Input: v vector of unknowns [x,y,lambda] Output: a vector of three equations that equals zero. x&lt;-v[1]; y&lt;-[2]; lambda&lt;-v[3] Assigns elements of vector v to our variables. c(...) combines our three equations into a vector: Lx followed by Ly then Llambda It will solve these three to find x,y, lambda nleqslv(start,f) start=c(1,1,0.1) is the initial guess for our variables. You can use different values but always pick positive numbers near expected magnitude. The simplest and safest is simply this combination. The results we are interested in is the first: $x is the solution that will give us the optimal bundle. The numbers under $x : \\(x^*\\)=optimal quantity of good X \\(y^*\\)=optimal quantity of good Y \\(\\lambda^*\\) = shadow price of budget 11.4.1.0.6 Second Derivatives Lxx&lt;-Deriv(Lx,&quot;x&quot;) Lyy&lt;-Deriv(Ly,&quot;y&quot;) Lxy&lt;-Deriv(Lx, &quot;y&quot;) These measure curvature 11.4.1.0.7 Constraint derivatives gx&lt;-Deriv(cons,&quot;x&quot;) gy&lt;-Deriv(cons,&quot;y&quot;) Needed for border rows. 11.4.1.0.8 Build Bordered Hessian x0&lt;-5 y0&lt;-2.5 lambda0&lt;-0.04 BH &lt;- matrix(c( 0, gx(x0,y0), gy(x0,y0), gx(x0,y0), Lxx(x0,y0,lambda0), Lxy(x0,y0,lambda0), gy(x0,y0), Lxy(x0,y0,lambda0), Lyy(x0,y0,lambda0) ), nrow=3, byrow=TRUE) BH ## [,1] [,2] [,3] ## [1,] 0 -10.00000000 -20.00000000 ## [2,] -10 -0.03535534 0.07071068 ## [3,] -20 0.07071068 -0.14142136 11.4.1.0.9 Get Determinant The rule of thumb is: \\(D&lt;0\\) maximum (utility maximization) \\(D&gt;0\\) minimum (cost minimization) det(BH) ## [1] 56.56854 11.4.1.0.10 Making the Bordered Hessian BH = \\begin{bmatrix} 0 &amp; -10 &amp; -20 \\\\ -10 &amp; -0.04 &amp; 0.07 \\\\ -20 &amp; 0.07 &amp; -0.14 \\end{bmatrix} \\(BH = \\begin{bmatrix} 0 &amp; -10 &amp; -20 \\\\ -10 &amp; -0.04 &amp; 0.07 \\\\ -20 &amp; 0.07 &amp; -0.14 \\end{bmatrix}\\) 11.5 Example 1 Objective Function: \\(\\pi(L,K)=50L^{0.5}K^{0.5}-10L-20K\\) Constraint: \\(Q(L,K)=L^{0.5}K^{0.5}=25\\) Lagrangian: \\(\\mathcal{L}=50L^{0.5}K^{0.5}-10L-20K+\\lambda(-25+L^{0.5}K^{0.5})\\) 11.5.0.0.1 Define function: profit&lt;-\\(L,K) 50*L^0.5*K^0.5-10*L-20*K constraint&lt;- \\(L,K) -25+L^0.5*K^0.5 11.5.0.0.2 Set up the Lagrangian L1&lt;-\\(L,K, lambda) profit(L,K)+lambda*constraint(L,K) 11.5.0.0.3 First Order Derivatives ll&lt;-Deriv(L1,&quot;L&quot;) lk&lt;-Deriv(L1, &quot;K&quot;) ll2&lt;-Deriv(L1, &quot;lambda&quot;) ll ## function (L, K, lambda) ## (0.5 * lambda + 25) * sqrt(K)/sqrt(L) - 10 lk ## function (L, K, lambda) ## (0.5 * lambda + 25) * sqrt(L)/sqrt(K) - 20 ll2 ## function (L, K, lambda) ## constraint(L, K) 11.5.0.0.4 Solve FOCs f &lt;- function(v){ L &lt;- v[1] K &lt;- v[2] lambda &lt;- v[3] c( ((0.5 * lambda + 25) * sqrt(K)/sqrt(L)) - 10, ((0.5 * lambda + 25) * sqrt(L)/sqrt(K)) - 20, -25+L^0.5 * K^0.5 ) } sols &lt;- nleqslv(c(10,10,1), f) sols$x ## [1] 35.35534 17.67767 -21.71573 11.5.0.0.5 Second Derivatives lll&lt;-Deriv(ll,&quot;L&quot;) lkk&lt;-Deriv(lk, &quot;K&quot;) llk&lt;-Deriv(ll, &quot;K&quot;) 11.5.0.0.6 Constraint Derivatives gl&lt;-Deriv(constraint,&quot;L&quot;) gk&lt;-Deriv(constraint, &quot;K&quot;) 11.5.0.0.7 Build Bordered Hessian L0&lt;-sols$x[1] K0&lt;-sols$x[2] lambda0&lt;-sols$x[3] BH &lt;- matrix(c( 0, gl(L0,K0), gk(L0,K0), gl(L0,K0), lll(L0,K0,lambda0), llk(L0,K0,lambda0), gk(L0,K0), llk(L0,K0,lambda0), lkk(L0,K0,lambda0) ), nrow=3, byrow=TRUE) BH ## [,1] [,2] [,3] ## [1,] 0.0000000 0.3535534 0.7071068 ## [2,] 0.3535534 -0.1414214 0.2828427 ## [3,] 0.7071068 0.2828427 -0.5656854 11.5.0.0.8 Get Determinant det(BH) ## [1] 0.2828427 11.5.1 Example 2 \\(U=xy\\) Constraint: \\(10-x+y=0\\) 11.5.1.0.1 Next steps: Try in class 11.6 Interpretations: Objective Function Interpretation of \\(x^*, y^*\\) Profit function combination of inputs or outputs that maximizes profit given the constraint Utility function optimal consumption bundle that maximizes utility subject to budget Cost function least-costly combination of inputs to produce an output Revenue function combination of prices/quantities that maximizes revenue subject to constraint 11.7 Exercise: You encounter this function: \\(\\pi(L,K)=-L^2-K^2+4L+6K\\) Provide the first order derivatives, second order derivatives, cross-partial derivatives Use Young’s theorem to confirm symmetry Evaluate at critical points (0,0) Construct the Hessian matrix Compute the determinant to check if maximum, minimum, saddle point Your final answers should be giving the first order derivatives, second order derivatives, cross-partial derivatives, Young’s theorem, Hessian matrix, determinant and determination(max, min, or saddle) For number 2: Provide the first order derivatives, second order derivatives, cross-partial derivatives Use Young’s theorem to confirm symmetry Evaluate at critical points (0,0) Construct the Hessian matrix Compute the determinant to check if maximum, minimum, saddle point Your final answers should be giving the first order derivatives, second order derivatives, cross-partial derivatives, Young’s theorem, Hessian matrix, determinant and determination(max, min, or saddle) The question depends on your middle initials (A=1, B=2…Z=26). Before answering, show the sum of your middle initials (i.e. Partner A M.I.=B, Partner B M.I.=E so 5) The function you need to answer would depend on it: Sum of Initials Assigned Function Evaluate at critical points 2-15 Function 2 (7,9) 16-30 Function 3 (3,4) 31-52 Function 4 (5,1) Additionally, evaluate at critical points assigned Construct new Hessian matrix Compute the determinant to check if maximum, minimum, saddle point Your final answers should be giving the first order derivatives, second order derivatives, cross-partial derivatives, Young’s theorem, Hessian matrix, determinant and determination(max, min, or saddle) You have this information: \\(\\mathcal{L}=\\sqrt{x}\\sqrt{y}+\\lambda(100-10x-20y)\\) Get first order conditions Solve for the optimal bundle Get Second Derivatives Get Constraint Derivatives Build Bordered Hessian Get Determinants and Determination Your final answers should be giving the first order derivatives, second order derivatives, constraint derivatives, optimal bundle, Bordered Hessian matrix, determinant and determination(max, min, or inconclusive) Provide the first order derivatives, second order derivatives, constraint derivatives, optimal bundle, Bordered Hessian matrix, determinant and determination(max, min, or inconclusive) for Example 2 of Bordered Hessian examples. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
